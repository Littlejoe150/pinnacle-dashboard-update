<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinnacle Reading Advantage</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --primary-dark: #345683;
            --secondary-color: #ff7d54;
            --text-color: #333333;
            --light-bg: #f5f7fa;
            --white: #ffffff;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--light-bg);
            padding: 20px;
        }

        .back-to-dashboard {
            position: fixed;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #28a745, #34ce57);
            color: white;
            padding: 8px 16px;
            text-decoration: none;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .back-to-dashboard:hover {
            background: linear-gradient(135deg, #34ce57, #40d568);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        /* Copyright notice styles */
        .copyright-notice {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 5px solid #e74c3c;
        }

        .copyright-notice p {
            margin: 5px 0;
            font-size: 0.9rem;
        }

        .copyright-notice .main-copyright {
            font-weight: bold;
            font-size: 1rem;
            color: #ecf0f1;
        }

        .copyright-notice .legal-text {
            color: #bdc3c7;
            font-size: 0.85rem;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #4b0082, #6a1b9a); /* Purple gradient background */
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(75, 0, 130, 0.3);
            padding: 30px 20px 35px;
        }
        
        /* White stripe and green inner area */
        header::before {
            content: "";
            position: absolute;
            top: 8px;
            left: 8px;
            right: 8px;
            bottom: 8px;
            background: linear-gradient(135deg, #0d5e20, #1a7531); /* Green gradient */
            border: 3px solid white; /* White stripe */
            border-radius: 10px;
            pointer-events: none;
            z-index: 0;
        }
        
        /* Decorative accent in corner */
        header::after {
            content: "";
            position: absolute;
            bottom: -20px;
            right: -20px;
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%);
            z-index: 0;
            border-radius: 50%;
        }
        
        /* Make sure content is above the background */
        header h1, header p, header div {
            position: relative;
            z-index: 1;
        }

        h1 {
            color: #4b0082; /* Dark purple text */
            margin-bottom: 20px;
            text-shadow: 2px 2px 3px rgba(0, 0, 0, 0.2);
            position: relative;
            display: inline-block;
            padding: 12px 25px;
            border-radius: 10px;
            background: #ffffff; /* White background */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15), 
                        inset 0 0 10px rgba(255, 255, 255, 0.8);
            font-size: 2.5rem;
            letter-spacing: 0.5px;
            transform: perspective(500px) rotateX(5deg);
            border: 2px solid #4b0082; /* Purple border */
        }
        
        /* Add subtle shine effect to heading */
        h1::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(to bottom, 
                        rgba(255,255,255,0.7) 0%, 
                        rgba(255,255,255,0) 100%);
            border-radius: 8px 8px 0 0;
            opacity: 0.6;
        }

        /* Tagline styles with staggered animation */
        .tagline {
            color: #ffffff; /* White text */
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
            font-weight: bold;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.4);
            position: relative;
            z-index: 1;
            background: rgba(75, 0, 130, 0.8); /* Dark purple background */
            display: block;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            padding: 8px 20px;
            border-radius: 50px; /* Rounded pill shape */
            border: 1px solid rgba(255, 255, 255, 0.5); /* Brighter white border */
            transition: all 0.3s ease;
            transform: translateY(0);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            opacity: 0;
            animation: fadeInUp 0.8s ease forwards;
        }
        
        /* Staggered animations for each tagline */
        .tagline:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .tagline:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        .tagline:nth-child(4) {
            animation-delay: 0.6s;
            font-style: italic;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .tagline:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            background: rgba(75, 0, 130, 0.9);
        }
        
        /* Add a subtle glow to the third tagline */
        .tagline:nth-child(3) {
            background: linear-gradient(90deg, rgba(75, 0, 130, 0.8), rgba(106, 27, 154, 0.8));
            animation: fadeInUp 0.8s ease forwards, glow 2s ease-in-out infinite alternate;
            animation-delay: 0.4s;
        }
        
        @keyframes glow {
            from {
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2), 0 0 5px rgba(75, 0, 130, 0.5);
            }
            to {
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2), 0 0 15px rgba(106, 27, 154, 0.8);
            }
        }

        /* Enhanced description section */
        .description {
            max-width: 900px;
            margin: 0 auto 40px auto;
            text-align: center;
            background: linear-gradient(145deg, #ffffff, #f5f7fa);
            padding: 30px 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.07), 
                        0 0 0 1px rgba(0, 0, 0, 0.02);
            position: relative;
            overflow: hidden;
            border-top: 4px solid #4b0082;
        }
        
        .description::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, #4b0082, #6a1b9a, #0d5e20, #1a7531);
            opacity: 0.8;
        }
        
        .section-title {
            color: #4b0082;
            font-size: 2.2rem;
            margin-bottom: 20px;
            position: relative;
            display: inline-block;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            bottom: -8px;
            left: 25%;
            width: 50%;
            height: 3px;
            background: linear-gradient(to right, #4b0082, #1a7531);
            border-radius: 3px;
        }
        
        .description p {
            font-size: 1.15rem;
            line-height: 1.6;
            color: #444;
            margin-bottom: 25px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .results-highlight {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .result-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 25px;
            background: rgba(75, 0, 130, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(75, 0, 130, 0.1);
            min-width: 220px;
            transition: all 0.3s ease;
        }
        
        .result-stat:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            background: rgba(75, 0, 130, 0.08);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #4b0082;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #4b0082, #1a7531);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .stat-text {
            font-size: 1rem;
            color: #555;
            text-align: center;
        }
        
        /* Enhanced premium banner */
        .premium-banner {
            position: relative;
            max-width: 1200px;
            margin: 0 auto 50px;
            padding: 40px 30px;
            background: linear-gradient(to right, #f9f9ff, #f0f5fa);
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.08);
            text-align: center;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        
        .banner-glow {
            position: absolute;
            top: -100px;
            left: -100px;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(75, 0, 130, 0.3) 0%, rgba(75, 0, 130, 0) 70%);
            border-radius: 50%;
            z-index: 0;
            animation: movingGlow 10s infinite alternate ease-in-out;
        }
        
        @keyframes movingGlow {
            0% {
                transform: translate(0, 0);
            }
            100% {
                transform: translate(900px, 200px);
            }
        }
        
        .premium-banner h2 {
            font-size: 2.5rem;
            color: #4b0082;
            margin-bottom: 15px;
            text-shadow: 0 2px 3px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1;
        }
        
        .banner-subtitle {
            font-size: 1.3rem;
            color: #555;
            margin-bottom: 40px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            position: relative;
            z-index: 1;
        }
        
        .premium-features {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            margin-bottom: 40px;
            position: relative;
            z-index: 1;
        }
        
        .feature-item {
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 16px;
            padding: 30px 25px;
            width: 100%;
            max-width: 300px;
            display: flex;
            align-items: flex-start;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            transition: all 0.4s ease;
            position: relative;
            border: 1px solid rgba(0, 0, 0, 0.05);
            overflow: hidden;
            text-align: left;
        }
        
        .feature-item::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(to right, #4b0082, #6a1b9a);
            opacity: 0.7;
        }
        
        .feature-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            background-color: rgba(255, 255, 255, 0.95);
        }
        
        .feature-icon {
            font-size: 26px;
            margin-right: 20px;
            color: #4b0082;
        }
        
        .icon-circle {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #4b0082, #6a1b9a);
            border-radius: 50%;
            color: white;
            box-shadow: 0 5px 15px rgba(75, 0, 130, 0.3);
        }
        
        .feature-text {
            flex: 1;
        }
        
        .feature-text h3 {
            color: #4b0082;
            margin-bottom: 10px;
            font-size: 1.3rem;
        }
        
        .feature-text p {
            color: #666;
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        
        .feature-tag {
            display: inline-block;
            padding: 5px 10px;
            background: rgba(75, 0, 130, 0.1);
            color: #4b0082;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .cta-container {
            margin-top: 20px;
            position: relative;
            z-index: 1;
        }
        
        .cta-text {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .premium-subscribe-btn {
            background: linear-gradient(135deg, #4b0082, #6a1b9a);
            color: white;
            border: none;
            padding: 12px 28px;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(75, 0, 130, 0.3);
            font-weight: bold;
        }
        
        .premium-subscribe-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(75, 0, 130, 0.4);
        }
        
        /* Enhanced Charts Showcase Section */
        .charts-showcase {
            background: linear-gradient(135deg, #f0f6ff, #f9f4ff);
            border-radius: 20px;
            padding: 60px 30px;
            margin: 0 auto 40px;
            max-width: 900px;
            text-align: center;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.06);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(75, 0, 130, 0.1);
        }
        
        .charts-showcase::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle at 20% 30%, rgba(75, 0, 130, 0.1) 0%, transparent 30%),
                             radial-gradient(circle at 80% 70%, rgba(26, 117, 49, 0.1) 0%, transparent 30%);
            opacity: 0.7;
        }
        
        .showcase-content {
            position: relative;
            z-index: 1;
        }
        
        .showcase-title {
            color: #4b0082;
            font-size: 2.4rem;
            margin-bottom: 15px;
            text-shadow: 0 2px 3px rgba(0,0,0,0.1);
        }
        
        .showcase-description {
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 30px;
            max-width: 700px;
            line-height: 1.6;
            margin-left: auto;
            margin-right: auto;
        }
        
        .testimonial {
            margin-top: 40px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(75, 0, 130, 0.1);
        }
        
        .quote {
            font-size: 1.1rem;
            font-style: italic;
            color: #333;
            margin-bottom: 15px;
            line-height: 1.5;
            position: relative;
            padding: 0 30px;
        }
        
        .quote::before, 
        .quote::after {
            content: "\201C";
            font-family: Georgia, serif;
            font-size: 3rem;
            position: absolute;
            color: rgba(75, 0, 130, 0.2);
            line-height: 1;
        }
        
        .quote::before {
            left: 0;
            top: -10px;
        }
        
        .quote::after {
            content: "\201D";
            right: 0;
            bottom: -30px;
        }
        
        .quote-author {
            font-size: 0.9rem;
            font-weight: bold;
            color: #444;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .color-square {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .long-vowel {
            background-color: #28a745; /* Green for long vowels (original color) */
        }

        .short-vowel {
            background-color: #dc3545; /* Red for short vowels */
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            background-color: var(--white);
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            cursor: pointer;
            transition: var(--transition);
        }

        .tab:first-child {
            border-top-left-radius: var(--border-radius);
            border-bottom-left-radius: var(--border-radius);
        }

        .tab:last-child {
            border-top-right-radius: var(--border-radius);
            border-bottom-right-radius: var(--border-radius);
        }

        .tab.active {
            background-color: var(--primary-color);
            color: var(--white);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .chart-container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 20px;
            margin-bottom: 30px;
        }

        .chart {
            display: table;
            position: relative;
            z-index: 10;
            border-collapse: separate;
            border-spacing: 8px;
            width: 100%;
            table-layout: fixed;
            margin: 0 auto;
        }
        
        .chart-row {
            display: table-row;
        }
        
        .vowel-header {
            display: table-cell;
            text-align: center;
            font-weight: bold;
            font-size: 2rem;
            padding: 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .vowel-header:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .vowel-header.selected {
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            transform: scale(1.1);
        }
        
        .vowel-header.long-vowel {
            color: white;
            background-color: #28a745; /* Green for long vowels (original color) */
            border-radius: 8px;
            padding: 5px;
            margin: 2px;
            min-width: 40px;
        }
        
        .vowel-header.short-vowel {
            color: white;
            background-color: #dc3545; /* Red for short vowels */
            border-radius: 8px;
            padding: 5px;
            margin: 2px;
            min-width: 40px;
        }
        
        .consonant-header {
            display: table-cell;
            text-align: center;
            font-weight: bold;
            padding: 15px;
            vertical-align: middle;
            font-size: 40px;
            min-width: 80px;
            min-height: 80px;
            background: linear-gradient(135deg, #4b0082, #6a1b9a);
            color: white !important;
            border-radius: 8px;
            margin: 2px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            z-index: 100;
            pointer-events: auto;
        }
        
        .consonant-header:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, #5b1092, #7a2ba9);
            border: 2px solid #ffcc00;
            color: white !important;
        }
        
        .consonant-header.selected {
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            transform: scale(1.05);
            color: white !important;
        }
        
        /* Force all consonant headers to always be white */
        .consonant-header,
        .consonant-header:hover,
        .consonant-header:active,
        .consonant-header:focus,
        .consonant-header.selected,
        .consonant-header:visited {
            color: white !important;
        }

        .chart-header {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            color: var(--primary-color);
            gap: 20px;
        }
        
        .chart-header .practice-btn {
            font-size: 0.9rem;
            padding: 8px 16px;
            margin: 0;
        }

        .selector-group {
            margin-bottom: 20px;
        }
        
        .vowel-selector, .consonant-selector {
            margin-bottom: 10px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .consonant-selector {
            padding-top: 8px;
            border-top: 1px dashed #e0e0e0;
        }

        .vowel-btn, .consonant-btn {
            padding: 8px 12px;
            background-color: var(--white);
            border: 1px solid var(--primary-color);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: bold;
        }
        
        .consonant-btn {
            background-color: #f8f9fa;
            border-color: #6c757d;
            color: #495057;
        }

        .vowel-btn.long-vowel-btn {
            color: white;
            background-color: #28a745; /* Green for long vowels (original color) */
        }

        .vowel-btn.short-vowel-btn {
            color: white;
            background-color: #dc3545;
        }

        .vowel-btn:hover, .vowel-btn.active, .consonant-btn:hover, .consonant-btn.active {
            background-color: var(--primary-color);
            color: var(--white) !important;
        }

        .blend-cell {
            background-color: #e9f0f9;
            padding: 20px 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            font-weight: normal;
            font-size: 36px !important; /* Further reduced two-letter font size */
            display: table-cell;
            min-width: 90px;
            min-height: 90px;
            line-height: 1;
        }
        
        /* Specific size for three-letter blends */
        #three-letter-chart .blend-cell {
            font-size: 32px !important; /* Even smaller for three-letter blends */
        }

        .blend-cell:hover {
            background-color: var(--primary-color);
            color: var(--white);
            transform: translateY(-3px);
        }

        .blend-cell.long-vowel-blend .vowel {
            color: inherit; /* Remove green color from vowels in the cells */
        }

        .blend-cell.short-vowel-blend .vowel {
            color: inherit; /* Remove red color from vowels in the cells */
        }

        .practice-section {
            max-width: 800px;
            margin: 40px auto 0;
            text-align: center;
        }

        .practice-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .practice-btn {
            background-color: #28a745; /* Original green color */
            color: var(--white);
            border: none;
            padding: 12px 24px;
            border-radius: var(--border-radius);
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
        }

        .practice-btn:hover {
            background-color: #218838; /* Original darker green on hover */
            transform: translateY(-2px);
        }
        
        .practice-tip {
            font-size: 14px;
            color: #666;
            font-style: italic;
            margin-bottom: 30px;
        }

        /* Enhanced Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
        }

        .modal-content {
            background-color: var(--white);
            margin: 2% auto;
            padding: 20px;
            width: 95%;
            max-width: 800px;
            max-height: 90vh;
            border-radius: 20px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            position: relative;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .premium-modal {
            background: linear-gradient(to bottom, #ffffff, #f9f4ff);
            border: 1px solid rgba(75, 0, 130, 0.1);
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        .modal-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #4b0082, #9400d3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(75, 0, 130, 0.2);
        }
        
        .modal-header h2 {
            color: #4b0082;
            font-size: 2.2rem;
            margin-bottom: 15px;
        }
        
        .modal-subtitle {
            color: #666;
            font-size: 1.1rem;
            line-height: 1.5;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .subscription-benefits {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            border: 1px solid rgba(75, 0, 130, 0.1);
        }
        
        .benefit-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .benefit-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #4b0082, #9400d3);
            color: white;
            border-radius: 50%;
            font-size: 0.9rem;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .benefit-text {
            flex: 1;
            font-size: 1rem;
            color: #333;
        }
        
        .guarantee {
            text-align: center;
            margin-top: 20px;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            padding-top: 20px;
            font-style: italic;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #aaa;
            z-index: 5;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            color: #4b0082;
            transform: rotate(90deg);
        }
        
        /* Enhanced subscription options */
        .subscription-options {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .subscription-option {
            flex: 1;
            min-width: 240px;
            background: white;
            border-radius: 15px;
            padding: 25px 20px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            position: relative;
            border: 1px solid rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }
        
        .subscription-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .subscription-option h3 {
            color: #333;
            font-size: 1.4rem;
            margin-bottom: 10px;
        }
        
        .subscription-option.highlight {
            background: linear-gradient(to bottom, #fcfaff, #ffffff);
            border: 1px solid rgba(75, 0, 130, 0.2);
            transform: scale(1.05);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            z-index: 2;
        }
        
        .subscription-option.highlight:hover {
            transform: scale(1.05) translateY(-5px);
        }
        
        .best-value {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #4b0082, #6a1b9a);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        
        .price {
            font-size: 2.5rem;
            font-weight: bold;
            color: #4b0082;
            margin: 15px 0;
        }
        
        .price span {
            font-size: 1rem;
            color: #666;
            font-weight: normal;
        }
        
        .savings {
            background: rgba(40, 167, 69, 0.1);
            color: #218838;
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .plan-features {
            list-style-type: none;
            padding: 0;
            margin: 20px 0;
            text-align: left;
        }
        
        .plan-features li {
            padding: 8px 0 8px 30px;
            position: relative;
            color: #555;
            font-size: 0.95rem;
        }
        
        .plan-features li:before {
            content: "âœ“";
            position: absolute;
            left: 5px;
            color: #28a745;
            font-weight: bold;
        }
        
        .subscribe-option-btn {
            background: linear-gradient(135deg, #4b0082, #6a1b9a);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 15px;
            box-shadow: 0 5px 15px rgba(75, 0, 130, 0.2);
        }
        
        .subscribe-option-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(75, 0, 130, 0.3);
        }
        
        .subscribe-option-btn.popular {
            background: linear-gradient(135deg, #3a0068, #4b0082);
            font-weight: bold;
            padding: 14px 25px;
        }

        .blend-display {
            font-size: 90px;
            font-weight: 500;
            margin: 10px 0;
            min-height: 160px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            line-height: 1;
            position: relative;
            top: -20px;
        }

        .blend-display .vowel {
            transition: var(--transition);
        }

        .blend-display.long-vowel-blend .vowel,
        .blend-display.short-vowel-blend .vowel {
            color: inherit; /* Same color as the rest of the text */
            font-weight: 500; /* Match the consonant font weight */
        }

        .timer-display {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .counter-display {
            font-size: 20px;
            margin-bottom: 10px;
            color: #6c757d;
            text-align: center;
            font-weight: 500;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            margin: 5px 0 15px 0;
        }

        .control-btn {
            padding: 10px 20px;
            border: 1px solid var(--primary-color);
            background: var(--white);
            color: var(--primary-color);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
        }

        .control-btn:hover:not(:disabled) {
            background: var(--primary-color);
            color: var(--white);
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .play-btn {
            background: #28a745; /* Original green color */
            color: var(--white);
            border: none;
        }

        .play-btn:hover {
            background: #218838; /* Original darker green on hover */
        }

        .session-settings {
            background-color: #f0f5fa;
            padding: 15px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }

        .settings-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        /* Goal Progress Styles - Removed */
        
        /* Book Integration Section */
        .book-integration {
            background: linear-gradient(145deg, #f5f9ff, #f0f6ff);
            padding: 60px 30px;
            margin: 0 auto 50px;
            border-radius: 20px;
            max-width: 1200px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.05);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(75, 0, 130, 0.1);
        }
        
        .book-integration::before {
            content: "";
            position: absolute;
            top: -100px;
            right: -100px;
            width: 250px;
            height: 250px;
            background: radial-gradient(circle, rgba(75, 0, 130, 0.07) 0%, rgba(75, 0, 130, 0) 70%);
            border-radius: 50%;
            z-index: 0;
        }
        
        .book-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            align-items: center;
            position: relative;
            z-index: 1;
        }
        
        .book-image-container {
            flex: 1;
            min-width: 250px;
            display: flex;
            justify-content: center;
        }
        
        .book-image {
            perspective: 1200px;
            width: 200px;
            height: 300px;
        }
        
        .book-cover {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateY(-30deg);
            transition: transform 1s ease;
            box-shadow: 5px 5px 20px rgba(0, 0, 0, 0.2);
        }
        
        .book-image:hover .book-cover {
            transform: rotateY(-15deg);
        }
        
        .book-spine {
            position: absolute;
            width: 40px;
            height: 100%;
            left: -20px;
            background: linear-gradient(to right, #3a0068, #4b0082);
            transform: rotateY(90deg) translateZ(-20px);
            transform-origin: right;
        }
        
        .book-front {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #4b0082, #6a1b9a);
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 0 5px 5px 0;
            padding: 20px;
            box-sizing: border-box;
            color: white;
            text-align: center;
        }
        
        .book-front::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0));
            border-radius: 0 5px 5px 0;
        }
        
        .book-front h3 {
            font-size: 1.8rem;
            line-height: 1.3;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            z-index: 1;
        }
        
        .book-details {
            flex: 2;
            min-width: 300px;
        }
        
        .book-details h2 {
            color: #4b0082;
            font-size: 2.2rem;
            margin-bottom: 20px;
            position: relative;
        }
        
        .book-details h2::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(to right, #4b0082, #6a1b9a);
            border-radius: 3px;
        }
        
        .book-description {
            color: #444;
            font-size: 1.15rem;
            line-height: 1.6;
            margin-bottom: 25px;
        }
        
        .book-benefits {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 30px 0;
        }
        
        .book-benefit {
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }
        
        .benefit-check {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #28a745;
            color: white;
            border-radius: 50%;
            font-size: 14px;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .book-benefit p {
            margin: 0;
            color: #333;
            font-size: 1.05rem;
            line-height: 1.5;
        }
        
        .highlight-text {
            font-weight: bold;
            color: #4b0082;
            font-style: italic;
            display: inline-block;
            position: relative;
        }
        
        .highlight-text::after {
            content: "";
            position: absolute;
            left: 0;
            bottom: -2px;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, #4b0082, #28a745);
            border-radius: 2px;
            opacity: 0.7;
        }
        
        .book-cta {
            margin-top: 30px;
        }
        
        .book-cta p {
            color: #666;
            margin-bottom: 15px;
            font-size: 1rem;
        }
        
        .amazon-button {
            display: inline-block;
            background: linear-gradient(to bottom, #f7dfa5, #f0c14b);
            border: 1px solid #a88734;
            border-radius: 3px;
            padding: 10px 20px;
            color: #111;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .amazon-button:hover {
            background: linear-gradient(to bottom, #f5d78e, #eeb933);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        /* Premium Content Styles */
        .premium-banner {
            background: linear-gradient(135deg, #f0f5fa, #ffffff);
            border-radius: var(--border-radius);
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: var(--box-shadow), 0 0 20px rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.8);
            position: relative;
            overflow: hidden;
        }
        
        /* Add subtle curved white highlight to premium banner */
        .premium-banner::before {
            content: "";
            position: absolute;
            top: -30px;
            left: -10%;
            width: 120%;
            height: 60px;
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(2deg);
            z-index: 1;
        }
        
        .premium-banner h2 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 2rem;
        }
        
        .premium-banner p {
            color: var(--text-color);
            margin-bottom: 30px;
            font-size: 1.1rem;
        }
        
        .premium-features {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .feature-item {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            width: 100%;
            max-width: 280px;
            display: flex;
            align-items: flex-start;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05), 0 0 15px rgba(255, 255, 255, 0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        
        .feature-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1), 0 0 30px rgba(255, 255, 255, 0.8);
        }
        
        .feature-icon {
            font-size: 2.5rem;
            margin-right: 15px;
            color: var(--primary-color);
        }
        
        .feature-text h3 {
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .feature-text p {
            font-size: 0.9rem;
            margin: 0;
            text-align: left;
        }
        
        .premium-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }
        
        .premium-btn, .premium-subscribe-btn {
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .premium-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }
        
        .premium-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .premium-subscribe-btn {
            background-color: #1a7531; /* Darker green (two shades darker) */
            color: white;
            border: none;
        }
        
        .premium-subscribe-btn:hover {
            background-color: #145c27; /* Even darker green on hover */
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        /* Settings button and modal */
        .settings-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            background-color: #1a7531; /* Darker green (two shades darker) */
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .settings-button:hover {
            background-color: #145c27; /* Even darker green on hover */
            transform: translateY(-2px);
        }
        
        #settings-modal .modal-content {
            max-width: 500px;
        }
        
        .voice-selector {
            margin-top: 20px;
        }
        
        .voice-selector select {
            width: 100%;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
            background-color: white;
            font-size: 16px;
            margin-top: 8px;
        }
        
        .voice-selector label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .settings-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }
        
        .test-voice-btn {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .save-settings-btn {
            background-color: #1a7531; /* Darker green (two shades darker) */
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        /* Subscription Modal Styles */
        .subscription-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        
        .subscription-option {
            background-color: var(--light-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            width: 100%;
            max-width: 240px;
            text-align: center;
            position: relative;
            transition: transform 0.3s ease;
        }
        
        .subscription-option:hover {
            transform: scale(1.03);
        }
        
        .subscription-option h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .price {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-color);
            margin-bottom: 20px;
        }
        
        .price span {
            font-size: 1rem;
            font-weight: normal;
            color: #666;
        }
        
        .savings {
            color: #28a745; /* Original green color */
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .subscribe-option-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .subscribe-option-btn:hover {
            background-color: var(--primary-dark);
        }
        
        .subscription-option.highlight {
            border: 2px solid #28a745; /* Original green color */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .best-value {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #28a745; /* Original green color */
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .settings-row {
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 10px;
        }

        .settings-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .settings-group label {
            font-weight: bold;
        }

        .settings-group select, .settings-group input {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        .info {
            margin-top: 20px;
            padding: 12px;
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            font-size: 12px;
            font-weight: bold;
            border: 2px solid #28a745; /* Original green color */
            text-align: center;
        }
        
        /* Decoding Blends Charts Button Styles */
        .magic-charts-button-container {
            display: flex;
            justify-content: center;
            margin: 40px 0;
        }
        
        .magic-charts-btn {
            background: linear-gradient(135deg, #4b0082, #8a2be2);
            color: white;
            font-size: 28px;
            font-weight: bold;
            font-family: 'Arial', sans-serif;
            padding: 20px 50px;
            border: 3px solid gold;
            border-radius: 50px; /* Makes it an oval shape */
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(75, 0, 130, 0.4),
                        inset 0 0 10px rgba(255, 255, 255, 0.3);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
            z-index: 1;
        }
        
        .magic-charts-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(75, 0, 130, 0.5),
                        inset 0 0 15px rgba(255, 255, 255, 0.4);
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
            border-color: #ffdf3f;
        }
        
        .magic-charts-btn:active {
            transform: translateY(0);
            box-shadow: 0 5px 15px rgba(75, 0, 130, 0.4);
        }
        
        /* Add ornate decorative elements */
        .magic-charts-btn:before,
        .magic-charts-btn:after {
            content: "âœ¦";
            position: absolute;
            font-size: 22px;
            color: gold;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .magic-charts-btn:before {
            left: 20px;
        }
        
        .magic-charts-btn:after {
            right: 20px;
        }
        
        /* Add glow effect */
        .magic-charts-btn {
            animation: glow 2s infinite alternate;
        }
        
        @keyframes glow {
            0% {
                box-shadow: 0 4px 15px rgba(75, 0, 130, 0.4),
                            inset 0 0 10px rgba(255, 255, 255, 0.3),
                            0 0 5px rgba(138, 43, 226, 0.5);
            }
            100% {
                box-shadow: 0 4px 15px rgba(75, 0, 130, 0.4),
                            inset 0 0 10px rgba(255, 255, 255, 0.3),
                            0 0 20px rgba(138, 43, 226, 0.8);
            }
        }
        
        /* Add subtle shimmer effect */
        .magic-charts-btn span {
            position: relative;
            z-index: 2;
        }
        
        .magic-charts-btn::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(30deg);
            transition: all 0.8s ease;
            z-index: 1;
        }
        
        .magic-charts-btn:hover::before {
            transform: rotate(30deg) translate(10%, 10%);
            opacity: 0.7;
        }
        
        /* Pulse animation for attention */
        @keyframes pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 4px 15px rgba(75, 0, 130, 0.4);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 4px 20px rgba(75, 0, 130, 0.6);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 4px 15px rgba(75, 0, 130, 0.4);
            }
        }
        
        .magic-charts-btn.pulse {
            animation: pulse 0.8s ease-in-out 3;
        }
        
        .practice-tip kbd {
            display: inline-block;
            padding: 3px 8px;
            font-size: 16px;
            line-height: 1.4;
            color: #fff;
            background-color: #28a745; /* Original green color for KBD */
            border: 1px solid #218838;
            border-radius: 3px;
            box-shadow: 0 2px 0 rgba(0,0,0,0.2);
            margin: 0 3px;
        }
        
        .info kbd {
            display: inline-block;
            padding: 1px 4px;
            font-size: 11px;
            line-height: 1.4;
            color: #fff;
            background-color: #28a745; /* Original green color for KBD */
            border: 1px solid #218838;
            border-radius: 3px;
            box-shadow: 0 1px 0 rgba(0,0,0,0.1);
            margin: 0 2px;
        }
        
        .practice-tip {
            margin: 20px auto;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            font-size: 18px;
            font-weight: bold;
            border: 2px solid #28a745; /* Original green color for border */
            text-align: center;
            max-width: 90%;
        }

        /* Practice session layout improvements */
        #practice-modal .modal-content {
            padding: 10px 20px;
        }

        .session-settings {
            margin-bottom: 10px;
        }

        .timer-display, .counter-display {
            margin: 5px 0;
            font-size: 16px;
        }

        @media (max-width: 768px) {
            .chart {
                width: 100%;
                border-spacing: 3px;
            }
            
            .vowel-header {
                font-size: 1.5rem;
                padding: 5px 0;
            }
            
            .blend-cell {
                font-size: 28px !important; /* Further reduced font size for mobile */
                padding: 15px 10px;
                min-width: 60px;
            }
            
            #three-letter-chart .blend-cell {
                font-size: 24px !important; /* Even smaller for three-letter blends on mobile */
            }
            
            .modal-content {
                margin: 20% auto;
                padding: 20px;
            }
            
            .blend-display {
                font-size: 70px;
                margin: 15px 0;
                min-height: 120px;
            }
            
            .vowel-selector {
                flex-direction: column;
                align-items: center;
            }
            
            .settings-row {
                flex-direction: column;
            }
        }

        /* Chart preview styles removed as requested */
        
        /* Styles for new benefit buttons and content */
        .benefits-toggle {
            width: 80%;
            max-width: 800px;
            padding: 14px 25px;
            font-size: 1.3rem;
            font-weight: 700;
            text-align: center;
            background: linear-gradient(135deg, #4b0082, #6a1b9a);
            color: white;
            border: 2px solid #fff;
            border-radius: 50px; /* Very rounded for oblong shape */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 20px auto; /* Center the button */
            position: relative;
        }
        
        .benefits-toggle::after {
            content: "â†’";
            position: absolute;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            transition: transform 0.3s ease;
            background: rgba(255,255,255,0.2);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .benefits-toggle.active::after {
            transform: translateY(-50%) rotate(90deg);
            background: rgba(255,255,255,0.4);
        }
        
        .benefits-toggle:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            background: linear-gradient(135deg, #5b1092, #7a2ba9);
            border-color: #ffcc00;
        }
        
        .benefits-content {
            padding: 20px 30px 35px;
            overflow: hidden;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            margin: 0 auto 30px;
            max-width: 900px;
            border: 1px solid rgba(75, 0, 130, 0.2);
        }
        
        .benefit-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            padding: 20px 25px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .benefit-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }
        
        .benefit-card h4 {
            color: #4b0082;
            font-size: 1.3rem;
            margin-bottom: 10px;
        }
        
        .benefit-card p {
            font-size: 1.05rem;
            line-height: 1.6;
            color: #444;
        }
        
        .benefit-conclusion {
            background: rgba(75, 0, 130, 0.05);
            padding: 15px 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }
        
        .benefit-conclusion p {
            font-size: 1.1rem;
            color: #4b0082;
            font-weight: 500;
        }
        
        .benefit-conclusion strong {
            color: #6a1b9a;
            font-weight: 700;
        }
        
        .navigation-list {
            margin-left: 25px;
            margin-bottom: 15px;
        }
        
        .numbered-list {
            margin-left: 25px;
            margin-bottom: 15px;
            counter-reset: item;
        }
        
        .numbered-list li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        /* Flash mode styles */
        #flash-mode {
            margin-right: 5px;
        }
        
        #flash-mode:checked + span {
            color: #4a6fa5;
            font-weight: bold;
        }
        
        /* Flash button active state */
        .flash-active #blend-display {
            animation: flashDisplay 0.3s ease-in-out;
        }
        
        @keyframes flashDisplay {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body>
    <!-- Copyright Notice -->
    <div class="copyright-notice">
        <p class="main-copyright">Â© 2025 Pinnacle Reading Advantage. All Rights Reserved.</p>
        <p class="legal-text">Educational methodology, content, and materials are protected by copyright law.</p>
        <p class="legal-text">Unauthorized reproduction, distribution, or commercial use is strictly prohibited.</p>
    </div>
    
    <a href="student-dashboard.html" class="back-to-dashboard">â† Back to Dashboard</a>
    <div id="status-display" style="font-size: 14px; color: #333; margin-top: 10px; text-align: center;"></div>











    <!-- Premium Content (Hidden by Default) -->
    <div id="premium-content" style="display: block;">
        <!-- Decoding Blends Charts Button Section -->
        <div class="charts-showcase">
            <div class="showcase-content">
                <h2 class="showcase-title">Experience the Magic</h2>
                <p class="showcase-description">Our unique approach to phonetic learning makes complex words easy to master. Click below to reveal the interactive charts that have helped thousands of students improve their reading skills.</p>
                <!-- Decoding Blends Charts Button -->
                <div class="magic-charts-button-container">
                    <button id="magic-charts-btn" class="magic-charts-btn"><span>Decoding Blends Charts</span></button>
                </div>
                <div class="testimonial">
                    <p class="quote">"The Decoding Blends Charts transformed my teaching approach completely. My students are now confident readers!"</p>
                    <p class="quote-author">â€” Maria T., Elementary Teacher</p>
                </div>
            </div>
        </div>
        
        <!-- Charts Area (Visible for Testing) -->
        <div id="charts-area" style="display: block;">
            <div class="legend">
                <div class="legend-item">
                    <div class="color-square long-vowel"></div>
                    <span>Long Vowels (Ä, Ä“, Ä«, Å, Å«)</span>
                </div>
                <div class="legend-item">
                    <div class="color-square short-vowel"></div>
                    <span>Short Vowels (Äƒ, Ä•, Ä­, Å, Å­)</span>
                </div>
            </div>

            <div class="tabs">
                <div class="tab active" data-tab="two-letter">Two-Letter Chart</div>
                <div class="tab" data-tab="three-letter">Three-Letter Chart</div>
            </div>

            <div class="tab-content active" id="two-letter-content">
                <div class="chart-container">
                    <div class="chart-header">
                        <h2>Two-Letter Blends</h2>
                        <button class="practice-btn" id="show-all-two-letter-btn">Show All Blends</button>
                    </div>
                    
                    <div class="selector-group">
                        <div class="vowel-selector" id="two-letter-vowels">
                            <!-- Vowel selector buttons will be added here by JavaScript -->
                        </div>
                        
                        <div class="consonant-selector" id="two-letter-consonants">
                            <!-- Consonant selector buttons will be added here by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="chart" id="two-letter-chart"></div>
                </div>
            </div>

            <div class="tab-content" id="three-letter-content">
                <div class="chart-container">
                    <div class="chart-header">
                        <h2>Three-Letter Blends</h2>
                        <button class="practice-btn" id="show-all-three-letter-btn">Show All Blends</button>
                    </div>
                    
                    <div class="selector-group">
                        <div class="vowel-selector" id="three-letter-vowels">
                            <!-- Vowel selector buttons will be added here by JavaScript -->
                        </div>
                        
                        <div class="consonant-selector" id="three-letter-consonants">
                            <!-- Consonant selector buttons will be added here by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="chart" id="three-letter-chart"></div>
                </div>
            </div>

            <div class="practice-section">
                <div class="practice-options">
                    <button class="practice-btn" id="show-all-btn">Show All Blends</button>
                    <button class="practice-btn" id="practice-row-btn">Practice Selected Vowels</button>
                    <button class="practice-btn" id="practice-consonants-btn">Practice Selected Consonant Rows</button>
                    <button class="practice-btn" id="practice-chart-btn">Practice Entire Chart</button>
                </div>
                <div class="practice-tip">
                    <p>ðŸ–±ï¸ INTERACTIVE HEADERS ðŸ–±ï¸</p>
                    <p><strong>Click vowel headers</strong> (A, E, I, O, U) to select columns for practice</p>
                    <p><strong>Click consonant headers</strong> (letters on the left) to select rows for practice</p>
                    <p>Hold <kbd>SHIFT</kbd> while clicking to select multiple headers for combination practice</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Subscribe Modal -->
    <div class="modal" id="subscribe-modal">
        <div class="modal-content premium-modal">
            <span class="close-modal">&times;</span>
            <div class="modal-header">
                <div class="modal-icon">âœ¨</div>
                <h2>Unlock Premium Access</h2>
                <p class="modal-subtitle">Get full access to our complete collection of phonetic charts, audio tools, and personalized practice modes.</p>
            </div>
            
            <div class="subscription-benefits">
                <div class="benefit-item">
                    <div class="benefit-icon">âœ“</div>
                    <div class="benefit-text">Unlimited access to all Decoding Blends Charts</div>
                </div>
                <div class="benefit-item">
                    <div class="benefit-icon">âœ“</div>
                    <div class="benefit-text">Premium audio pronunciation guides</div>
                </div>
                <div class="benefit-item">
                    <div class="benefit-icon">âœ“</div>
                    <div class="benefit-text">Customizable practice sessions</div>
                </div>
                <div class="benefit-item">
                    <div class="benefit-icon">âœ“</div>
                    <div class="benefit-text">Advanced session-based progress tracking</div>
                </div>
                <div class="benefit-item">
                    <div class="benefit-icon">âœ“</div>
                    <div class="benefit-text">Classroom usage rights (1 teacher + 30 students)</div>
                </div>
            </div>
            
            <div class="subscription-options">
                <div class="subscription-option">
                    <h3>Monthly Access</h3>
                    <div class="price">$9.99<span>/month</span></div>
                    <ul class="plan-features">
                        <li>No long-term commitment</li>
                        <li>Cancel anytime</li>
                        <li>All premium features</li>
                    </ul>
                    <button class="subscribe-option-btn" data-plan="monthly">Get Started</button>
                </div>
                
                <div class="subscription-option highlight">
                    <div class="best-value">Best Value</div>
                    <h3>Annual Access</h3>
                    <div class="price">$89.99<span>/year</span></div>
                    <div class="savings">Save 25%</div>
                    <ul class="plan-features">
                        <li>Best value option</li>
                        <li>Full year of access</li>
                        <li>All premium features</li>
                    </ul>
                    <button class="subscribe-option-btn popular" data-plan="annual">Select Annual Plan</button>
                </div>
            </div>
            
            <div class="guarantee">
                <p>30-day money-back guarantee. No questions asked.</p>
            </div>
        </div>
    </div>

    <!-- Practice Modal -->
    <div class="modal" id="practice-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Practice Session</h2>
            
            <div class="session-settings">
                <div class="settings-row">
                    <div class="settings-group">
                        <label for="practice-mode">Mode:</label>
                        <select id="practice-mode">
                            <option value="sequential">Sequential Order</option>
                            <option value="random">Random Order</option>
                        </select>
                    </div>
                    <div class="settings-group">
                        <label for="timer-setting">Timer (seconds):</label>
                        <input type="number" id="timer-setting" min="1" max="10" value="4">
                    </div>
                    <div class="settings-group">
                        <label for="flash-mode">
                            <input type="checkbox" id="flash-mode">
                            Flash Mode (300ms)
                        </label>
                    </div>
                    <div class="settings-group">
                        <label for="ultra-flash-mode">
                            <input type="checkbox" id="ultra-flash-mode">
                            Ultra Flash Mode (200ms)
                        </label>
                    </div>
                </div>
                <!-- Goal feature removed -->
            </div>
            
            <div class="practice-content-area">
                <div class="timer-display" id="timer-display"></div>
                <div class="counter-display" id="counter-display">Blends practiced: 0</div>
                <div class="blend-display" id="blend-display"></div>
                
                <div class="controls">
                    <button class="control-btn" id="prev-btn" disabled>Previous</button>
                    <button class="control-btn play-btn" id="play-btn">Play Sound</button>
                    <button class="control-btn" id="next-btn">Next</button>
                </div>
            </div>
            
            <div class="info">
                <p>âŒ¨ï¸ KEYBOARD SHORTCUTS âŒ¨ï¸</p>
                <p>Press <kbd>SPACEBAR</kbd> to advance to the next blend<br>
                Press <span style="font-weight: 900; font-size: 14px;">P</span> key to play the current blend's sound</p>
            </div>
            
            <div style="text-align: center; margin-top: 1.5rem;">
                <button class="control-btn" id="finish-practice-btn">Finish Practice</button>
            </div>
        </div>
    </div>

    <script>
        // Chart data for two and three letter blends
        const chartData = {
            twoLetter: {
                consonants: ['b', 'c', 'd', 'f', 'g', 'h', 'j', 'k', 'l', 'm', 'n', 'p', 'r', 's', 't', 'v', 'w', 'y', 'z'],
                vowels: [
                    { symbol: 'Ä', type: 'long', example: 'cake' },
                    { symbol: 'Ä“', type: 'long', example: 'bee' },
                    { symbol: 'Ä«', type: 'long', example: 'kite' },
                    { symbol: 'Å', type: 'long', example: 'boat' },
                    { symbol: 'Å«', type: 'long', example: 'cube' },
                    { symbol: 'Äƒ', type: 'short', example: 'cat' },
                    { symbol: 'Ä•', type: 'short', example: 'bed' },
                    { symbol: 'Ä­', type: 'short', example: 'sit' },
                    { symbol: 'Å', type: 'short', example: 'pot' },
                    { symbol: 'Å­', type: 'short', example: 'cup' }
                ]
            },
            threeLetter: {
                onsets: ['bl', 'cl', 'fl', 'gl', 'sl', 'pl', 'tw', 'qu', 'br', 'cr', 'dr', 'fr', 'gr', 'pr', 'tr', 'ch', 'sh', 'sc', 'sm', 'sn', 'st', 'sw', 'th', 'wh', 'ph'],
                vowels: [
                    { symbol: 'Ä', type: 'long', example: 'cake' },
                    { symbol: 'Ä“', type: 'long', example: 'bee' },
                    { symbol: 'Ä«', type: 'long', example: 'kite' },
                    { symbol: 'Å', type: 'long', example: 'boat' },
                    { symbol: 'Å«', type: 'long', example: 'cube' },
                    { symbol: 'Äƒ', type: 'short', example: 'cat' },
                    { symbol: 'Ä•', type: 'short', example: 'bed' },
                    { symbol: 'Ä­', type: 'short', example: 'sit' },
                    { symbol: 'Å', type: 'short', example: 'pot' },
                    { symbol: 'Å­', type: 'short', example: 'cup' }
                ]
            }
        };

        // Current practice state
        let practiceState = {
            currentChartType: 'two-letter',
            currentVowel: null,
            currentConsonants: null,
            practicingVowelRow: false,
            practicingConsonantColumn: false,
            blends: [],
            currentIndex: 0,
            timerValue: 4,
            timerInterval: null,
            isPlaying: false,
            practiceCount: 0,
            flashMode: false,
            ultraFlashMode: false,
            flashTimer: null
        };

        // Selection arrays (like word wall)
        let selectedVowels = [];
        let selectedConsonants = [];
        
        // Copy exact word wall toggle functions
        function toggleColumn(vowelSymbol, event) {
            if (event.shiftKey) {
                const index = selectedVowels.indexOf(vowelSymbol);
                const button = event.target;
                
                if (index === -1) {
                    selectedVowels.push(vowelSymbol);
                    button.classList.add('selected');
                } else {
                    selectedVowels.splice(index, 1);
                    button.classList.remove('selected');
                }
                
                selectedConsonants = [];
                document.querySelectorAll('.consonant-header').forEach(btn => {
                    btn.classList.remove('selected');
                });
            } else {
                clearAllSelections();
                selectedVowels = [vowelSymbol];
                event.target.classList.add('selected');
            }
            
            const activeTab = document.querySelector('.tab.active').dataset.tab;
            filterChart(activeTab, selectedVowels.length > 0 ? selectedVowels : null);
            updatePracticeButtons();
        }

        function toggleRow(consonant, event) {
            console.log('toggleRow called with consonant:', consonant, 'event:', event);
            
            if (event.shiftKey) {
                const index = selectedConsonants.indexOf(consonant);
                const button = event.target;
                
                if (index === -1) {
                    selectedConsonants.push(consonant);
                    button.classList.add('selected');
                    console.log('Added consonant to selection:', consonant, 'Total selected:', selectedConsonants);
                } else {
                    selectedConsonants.splice(index, 1);
                    button.classList.remove('selected');
                    console.log('Removed consonant from selection:', consonant, 'Total selected:', selectedConsonants);
                }
                
                selectedVowels = [];
                document.querySelectorAll('.vowel-header').forEach(btn => {
                    btn.classList.remove('selected');
                });
            } else {
                clearAllSelections();
                selectedConsonants = [consonant];
                event.target.classList.add('selected');
                console.log('Single consonant selection:', consonant);
            }
            
            const activeTab = document.querySelector('.tab.active').dataset.tab;
            console.log('Filtering chart for consonants:', selectedConsonants, 'on tab:', activeTab);
            
            // CRITICAL: Add visual highlighting to consonant rows
            highlightConsonantRows(activeTab, selectedConsonants);
            
            filterChartByConsonants(activeTab, selectedConsonants.length > 0 ? selectedConsonants : null);
            updatePracticeButtons();
        }

        // CRITICAL FUNCTION: Highlight consonant rows with visual feedback
        function highlightConsonantRows(chartType, selectedConsonants) {
            console.log('Highlighting consonant rows for', chartType, ':', selectedConsonants);
            
            // Get the specific chart element
            const chartElement = document.getElementById(`${chartType}-chart`);
            if (!chartElement) {
                console.error('Chart element not found:', `${chartType}-chart`);
                return;
            }
            
            // Clear existing highlights in this chart
            chartElement.querySelectorAll('.chart-row').forEach(row => {
                row.classList.remove('selected');
                row.style.background = '';
                row.style.transform = '';
                row.style.boxShadow = '';
                row.style.border = '';
                row.style.borderRadius = '';
            });
            
            // Clear existing consonant header highlights
            chartElement.querySelectorAll('.consonant-header').forEach(header => {
                header.classList.remove('selected');
                header.style.background = '';
                header.style.color = '';
                header.style.transform = '';
                header.style.boxShadow = '';
                header.style.border = '';
            });
            
            // Add highlights for selected consonants
            if (selectedConsonants && selectedConsonants.length > 0) {
                selectedConsonants.forEach(consonant => {
                    const consonantLower = consonant.toLowerCase();
                    
                    // Find rows that match this consonant
                    const chartRows = chartElement.querySelectorAll('.chart-row');
                    
                    for (let i = 1; i < chartRows.length; i++) { // Skip header row
                        const row = chartRows[i];
                        const consonantHeader = row.querySelector('.consonant-header');
                        
                        if (consonantHeader) {
                            const rowConsonant = consonantHeader.textContent.toLowerCase().trim();
                            
                            if (rowConsonant === consonantLower) {
                                // Highlight the entire row with dark purple background and dark border
                                row.classList.add('selected');
                                row.style.background = 'rgba(75, 0, 130, 0.8)';
                                row.style.transform = 'scale(1.02)';
                                row.style.boxShadow = '0 2px 8px rgba(75, 0, 130, 0.6)';
                                row.style.border = '4px solid #000000';
                                row.style.borderRadius = '8px';
                                
                                // Highlight the consonant header with dramatic styling
                                consonantHeader.classList.add('selected');
                                consonantHeader.style.background = 'linear-gradient(135deg, #ffd700, #ff8c00)';
                                consonantHeader.style.color = '#ffffff';
                                consonantHeader.style.transform = 'scale(1.15)';
                                consonantHeader.style.boxShadow = '0 0 15px rgba(255, 215, 0, 0.8)';
                                consonantHeader.style.border = '4px solid #000000';
                                
                                console.log(`âœ… Highlighted consonant row: ${rowConsonant}`);
                            }
                        }
                    }
                });
            }
        }

        function clearAllSelections() {
            selectedVowels = [];
            selectedConsonants = [];
            document.querySelectorAll('.vowel-header, .consonant-header').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Clear all visual highlights
            document.querySelectorAll('.chart-row').forEach(row => {
                row.classList.remove('selected');
                row.style.background = '';
                row.style.transform = '';
                row.style.boxShadow = '';
                row.style.border = '';
                row.style.borderRadius = '';
            });
            
            document.querySelectorAll('.consonant-header').forEach(header => {
                header.classList.remove('selected');
                header.style.background = '';
                header.style.color = '';
                header.style.transform = '';
                header.style.boxShadow = '';
                header.style.border = '';
            });
            
            // Reset chart to show all blends
            const activeTab = document.querySelector('.tab.active').dataset.tab;
            filterChart(activeTab, null);
            filterChartByConsonants(activeTab, null);
            
            updatePracticeButtons();
        }

        function updatePracticeButtons() {
            const practiceRowBtn = document.getElementById('practice-row-btn');
            const practiceConsonantsBtn = document.getElementById('practice-consonants-btn');
            
            if (selectedVowels.length > 0) {
                practiceRowBtn.textContent = `Practice Selected Vowels (${selectedVowels.length})`;
                practiceRowBtn.style.background = 'linear-gradient(135deg, #28a745, #34ce57)';
            } else {
                practiceRowBtn.textContent = 'Practice Selected Vowels';
                practiceRowBtn.style.background = '';
            }
            
            if (selectedConsonants.length > 0) {
                const activeTab = document.querySelector('.tab.active').dataset.tab;
                const label = activeTab === 'three-letter' ? 'Consonant Blends' : 'Consonant Rows';
                practiceConsonantsBtn.textContent = `Practice Selected ${label} (${selectedConsonants.length})`;
                practiceConsonantsBtn.style.background = 'linear-gradient(135deg, #28a745, #34ce57)';
            } else {
                practiceConsonantsBtn.textContent = 'Practice Selected Consonant Rows';
                practiceConsonantsBtn.style.background = '';
            }
        }
        
        // Create a simple bell sound for goal achievement (more browser compatible)
        function playAchievementSound() {
            // Use the Web Audio API which has better browser compatibility
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                // Connect the oscillator to a gain node (volume control)
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Set up a cheerful "ta-da" sound (frequency changes)
                oscillator.type = 'triangle';
                oscillator.frequency.setValueAtTime(440, audioContext.currentTime); // A4
                oscillator.frequency.exponentialRampToValueAtTime(880, audioContext.currentTime + 0.1); // A5
                oscillator.frequency.exponentialRampToValueAtTime(587.33, audioContext.currentTime + 0.2); // D5
                oscillator.frequency.exponentialRampToValueAtTime(659.26, audioContext.currentTime + 0.3); // E5
                oscillator.frequency.exponentialRampToValueAtTime(880, audioContext.currentTime + 0.4); // Back to A5
                
                // Volume envelope - start at zero, ramp up quickly, then fade out
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.8, audioContext.currentTime + 0.05);
                gainNode.gain.linearRampToValueAtTime(0.5, audioContext.currentTime + 0.2);
                gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.6);
                
                // Start and stop the sound
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.6);
                
                console.log('Web Audio API success sound played');
                
                // Create a second oscillator for harmony
                const oscillator2 = audioContext.createOscillator();
                oscillator2.connect(gainNode);
                oscillator2.type = 'sine';
                oscillator2.frequency.setValueAtTime(220, audioContext.currentTime); // A3
                oscillator2.frequency.exponentialRampToValueAtTime(440, audioContext.currentTime + 0.1); // A4
                oscillator2.frequency.exponentialRampToValueAtTime(293.66, audioContext.currentTime + 0.2); // D4
                oscillator2.frequency.exponentialRampToValueAtTime(329.63, audioContext.currentTime + 0.3); // E4
                oscillator2.frequency.exponentialRampToValueAtTime(440, audioContext.currentTime + 0.4); // Back to A4
                
                oscillator2.start(audioContext.currentTime);
                oscillator2.stop(audioContext.currentTime + 0.6);
                
                return true;
            } catch (e) {
                console.error('Web Audio API failed:', e);
                
                // Fallback to the simple Audio API
                try {
                    // Create a simple beep sound using the Audio API
                    const beep = new Audio("data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU9vT18AAAAA//////////////////////////////////////////8=");
                    beep.volume = 1.0;
                    beep.play();
                    console.log('Fallback audio played');
                    return true;
                } catch (e2) {
                    console.error('Fallback audio failed:', e2);
                    return false;
                }
            }
        }

        // Initialize the application
        // Flag to track premium status (simulated) - set to true for demo
        let isPremiumUser = true;
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Page loaded, initializing charts...');
            
            // Show premium content by default for testing
            document.getElementById('premium-content').style.display = 'block';
            
            // Goal feature removed
            
            // Setup vowel selectors
            // setupVowelSelectors() removed - now using clickable chart headers
            
            // Generate the charts
            console.log('Generating charts...');
            generateTwoLetterChart();
            generateThreeLetterChart();
            
            // Set up tab switching
            setupTabs();
            
            // Set up practice session
            setupPractice();
            
            // Set up keyboard controls
            setupKeyboardControls();
            
            // Setup premium access functionality
            setupPremiumAccess();
            
            // Verify charts were generated properly and TEST CLICKS
            setTimeout(() => {
                const twoLetterChart = document.getElementById('two-letter-chart');
                const threeLetterChart = document.getElementById('three-letter-chart');
                const consonantHeaders = document.querySelectorAll('.consonant-header');
                
                console.log('Two-letter chart rows:', twoLetterChart.querySelectorAll('.chart-row').length);
                console.log('Three-letter chart rows:', threeLetterChart.querySelectorAll('.chart-row').length);
                console.log('Total consonant headers found:', consonantHeaders.length);
                
                // TEST EACH CONSONANT HEADER
                console.log('ðŸ§ª TESTING CONSONANT HEADERS:');
                consonantHeaders.forEach((header, index) => {
                    const text = header.textContent.trim();
                    console.log(`Header ${index}: "${text}" onclick:`, typeof header.onclick, 'addEventListener:', header.hasAttribute ? 'available' : 'no hasAttribute');
                    
                    if (header.onclick) {
                        console.log(`âœ… onclick is set for: "${text}"`);
                    } else {
                        console.log(`âŒ onclick is NOT set for: "${text}"`);
                        // Try to fix it manually
                        if (text && text !== '') {
                            console.log(`ðŸ”§ Manually setting onclick for: "${text}"`);
                            header.onclick = function(e) {
                                console.log('ðŸ”¥ MANUAL FIX CLICK:', text, e);
                                toggleRow(text, e);
                            };
                        }
                    }
                });
                
                console.log('âœ… Charts generated successfully with onclick events!');
            }, 500);
        });
        
        // Setup premium access buttons and modals
        function setupPremiumAccess() {
            // Get premium elements
            const subscribeBtn = document.getElementById('subscribe-btn');
            const subscribeBtnTwoLetter = document.getElementById('subscribe-btn-2l');
            const subscribeBtnThreeLetter = document.getElementById('subscribe-btn-3l');
            const premiumContent = document.getElementById('premium-content');
            const subscribeModal = document.getElementById('subscribe-modal');
            const closeSubscribeModal = subscribeModal.querySelector('.close-modal');
            const subscribePlanBtns = document.querySelectorAll('.subscribe-option-btn');
            
            // Subscribe button for main CTA
            subscribeBtn.addEventListener('click', function() {
                showSubscribeModal();
            });
            
            // Subscribe button for two-letter preview
            subscribeBtnTwoLetter.addEventListener('click', function() {
                showSubscribeModal();
            });
            
            // Subscribe button for three-letter preview
            subscribeBtnThreeLetter.addEventListener('click', function() {
                showSubscribeModal();
            });
            
            // Close subscribe modal
            closeSubscribeModal.addEventListener('click', function() {
                subscribeModal.style.display = 'none';
            });
            
            // Handle subscription plan selection
            subscribePlanBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const plan = this.dataset.plan;
                    // Simulate successful subscription
                    isPremiumUser = true;
                    subscribeModal.style.display = 'none';
                    
                    // Show success message
                    alert(`Thank you for subscribing to the ${plan} plan! You now have premium access.`);
                    
                    // Show premium content
                    premiumContent.style.display = 'block';
                    window.scrollTo({ top: premiumContent.offsetTop, behavior: 'smooth' });
                    
                    // Update UI to reflect premium status
                    document.querySelectorAll('.blur-overlay').forEach(overlay => {
                        overlay.style.display = 'none';
                    });
                    subscribeBtn.style.display = 'none';
                    
                    // Make sure to actually display the premium content - this is important
                    premiumContent.style.display = 'block';
                    
                    // Scroll to it so it's visible
                    setTimeout(() => {
                        window.scrollTo({ top: premiumContent.offsetTop, behavior: 'smooth' });
                    }, 500);
                });
            });
            
            // Function to show subscribe modal
            function showSubscribeModal() {
                subscribeModal.style.display = 'block';
            }
            
            // Close modal when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === subscribeModal) {
                    subscribeModal.style.display = 'none';
                }
            });
        }

        // Selector functions removed - now using clickable chart headers

        // Filter chart to show only blends with selected vowels
        function filterChart(chartType, vowels) {
            const chartElement = document.getElementById(`${chartType}-chart`);
            const blendCells = chartElement.querySelectorAll('.blend-cell');
            
            blendCells.forEach(cell => {
                if (!vowels || // If no vowels specified, show all
                    (Array.isArray(vowels) && vowels.includes(cell.dataset.vowel)) || // If cell's vowel is in the array
                    vowels === cell.dataset.vowel) { // For backward compatibility
                    cell.style.display = 'table-cell';
                } else {
                    cell.style.display = 'none';
                }
            });
            
            // Update practice state
            practiceState.currentChartType = chartType;
            practiceState.currentVowel = vowels; // Note: This now might be an array
        }
        
        // Filter chart to show only blends with selected consonants
        function filterChartByConsonants(chartType, consonants) {
            console.log('filterChartByConsonants called with:', chartType, consonants);
            
            const chartElement = document.getElementById(`${chartType}-chart`);
            const chartRows = chartElement.querySelectorAll('.chart-row');
            
            console.log('Found chart rows:', chartRows.length);
            
            // Skip the header row (index 0)
            for (let i = 1; i < chartRows.length; i++) {
                const row = chartRows[i];
                const consonantHeader = row.querySelector('.consonant-header');
                const rowConsonant = consonantHeader.textContent.toLowerCase(); // Make case-insensitive
                
                console.log(`Row ${i}: consonant="${rowConsonant}"`);
                
                if (!consonants || // If no consonants specified, show all
                    (Array.isArray(consonants) && consonants.map(c => c.toLowerCase()).includes(rowConsonant)) || // If row's consonant is in the array (case-insensitive)
                    consonants.toLowerCase() === rowConsonant) { // For backward compatibility (case-insensitive)
                    row.style.display = '';
                    console.log(`Showing row ${i} (${rowConsonant})`);
                } else {
                    row.style.display = 'none';
                    console.log(`Hiding row ${i} (${rowConsonant})`);
                }
            }
            
            // Update practice state for consonants
            practiceState.currentConsonants = consonants; // This might be an array
        }

        // Generate two-letter chart
        function generateTwoLetterChart() {
            const chartElement = document.getElementById('two-letter-chart');
            chartElement.innerHTML = '';
            
            // Create header row with vowels
            const headerRow = document.createElement('div');
            headerRow.className = 'chart-row';
            
            // Add empty cell for top-left corner
            const cornerCell = document.createElement('div');
            cornerCell.className = 'consonant-header';
            headerRow.appendChild(cornerCell);
            
            // Add vowel headers
            chartData.twoLetter.vowels.forEach(vowel => {
                const headerCell = document.createElement('div');
                headerCell.className = `vowel-header ${vowel.type}-vowel`;
                headerCell.textContent = vowel.symbol.toUpperCase();
                headerCell.title = `${vowel.symbol} as in "${vowel.example}" - Click to filter, Double-click to show all`;
                headerCell.dataset.vowel = vowel.symbol; // Store vowel for event handling
                
                // Use simple onclick like word wall - this works!
                headerCell.onclick = (e) => {
                    console.log('Vowel header clicked:', vowel.symbol);
                    toggleColumn(vowel.symbol, e);
                };
                headerCell.ondblclick = (e) => { 
                    clearAllSelections(); 
                    e.preventDefault(); 
                };
                
                headerRow.appendChild(headerCell);
            });
            
            chartElement.appendChild(headerRow);
            
            // Create rows for each consonant
            chartData.twoLetter.consonants.forEach(consonant => {
                const row = document.createElement('div');
                row.className = 'chart-row';
                
                // Add consonant header as first cell in row
                const consonantHeader = document.createElement('div');
                consonantHeader.className = 'consonant-header';
                consonantHeader.textContent = consonant;
                consonantHeader.title = `Click to filter ${consonant} row, Double-click to show all`;
                consonantHeader.dataset.consonant = consonant; // Store consonant for event handling
                
                // Use simple onclick like word wall - this works!
                consonantHeader.onclick = function(e) {
                    console.log('ðŸ”¥ CONSONANT CLICKED:', consonant, 'event:', e);
                    console.log('ðŸ”¥ Target element:', e.target);
                    console.log('ðŸ”¥ Current element:', e.currentTarget);
                    toggleRow(consonant, e);
                };
                consonantHeader.ondblclick = function(e) { 
                    console.log('ðŸ”¥ CONSONANT DOUBLE-CLICKED:', consonant);
                    clearAllSelections(); 
                    e.preventDefault(); 
                };
                
                // EXTRA TEST: Add direct test handler
                consonantHeader.addEventListener('click', function(e) {
                    console.log('ðŸš¨ addEventListener ALSO working for:', consonant);
                }, true);
                
                row.appendChild(consonantHeader);
                
                // Add blend cells for each vowel
                chartData.twoLetter.vowels.forEach(vowel => {
                    // Create the blend cell
                    const cell = document.createElement('div');
                    cell.className = `blend-cell ${vowel.type}-vowel-blend`;
                    cell.style.fontSize = "40px";
                    cell.style.padding = "15px";
                    cell.style.minWidth = "80px";
                    cell.style.minHeight = "80px";
                    
                    // Create the blend text without colored vowel
                    cell.innerHTML = `${consonant}${vowel.symbol}`;
                    
                    // Store the full blend with diacritical mark for audio
                    cell.dataset.blend = consonant + vowel.symbol;
                    cell.dataset.vowel = vowel.symbol;
                    cell.dataset.consonant = consonant;
                    
                    // Add click event for audio with special handling
                    cell.addEventListener('click', function() {
                        // Get the consonant and vowel for special handling
                        const consonantValue = this.dataset.consonant;
                        const vowelSymbol = this.dataset.vowel;
                        
                        // Special handling for problematic blends
                        if (vowelSymbol === 'Ä“') {
                            if (consonantValue === 'j') {
                                console.log("*** DIRECT: Playing 'jee' sound ***");
                                speakDirectText('jee');
                                return;
                            }
                            if (consonantValue === 'n') {
                                console.log("*** DIRECT: Playing 'nee' sound ***");
                                speakDirectText('nee');
                                return;
                            }
                        }
                        
                        // Regular processing for other blends
                        playBlendAudio(this.dataset.blend);
                    });
                    
                    row.appendChild(cell);
                });
                
                chartElement.appendChild(row);
            });
        }

        // Generate three-letter chart
        function generateThreeLetterChart() {
            const chartElement = document.getElementById('three-letter-chart');
            chartElement.innerHTML = '';
            
            // Create header row with vowels
            const headerRow = document.createElement('div');
            headerRow.className = 'chart-row';
            
            // Add empty cell for top-left corner
            const cornerCell = document.createElement('div');
            cornerCell.className = 'consonant-header';
            headerRow.appendChild(cornerCell);
            
            // Add vowel headers
            chartData.threeLetter.vowels.forEach(vowel => {
                const headerCell = document.createElement('div');
                headerCell.className = `vowel-header ${vowel.type}-vowel`;
                headerCell.textContent = vowel.symbol.toUpperCase();
                headerCell.title = `${vowel.symbol} as in "${vowel.example}" - Click to filter, Double-click to show all`;
                headerCell.dataset.vowel = vowel.symbol; // Store vowel for event handling
                
                // Use simple onclick like word wall - this works!
                headerCell.onclick = (e) => {
                    console.log('Vowel header clicked:', vowel.symbol);
                    toggleColumn(vowel.symbol, e);
                };
                headerCell.ondblclick = (e) => { 
                    clearAllSelections(); 
                    e.preventDefault(); 
                };
                
                headerRow.appendChild(headerCell);
            });
            
            chartElement.appendChild(headerRow);
            
            // Create rows for each onset
            chartData.threeLetter.onsets.forEach(onset => {
                const row = document.createElement('div');
                row.className = 'chart-row';
                
                // Add onset header as first cell in row
                const onsetHeader = document.createElement('div');
                onsetHeader.className = 'consonant-header';
                onsetHeader.textContent = onset;
                onsetHeader.title = `Click to filter ${onset} blend, Double-click to show all`;
                onsetHeader.dataset.consonant = onset; // Store onset for event handling
                
                // Use simple onclick like word wall - this works!
                onsetHeader.onclick = function(e) {
                    console.log('ðŸ”¥ ONSET CLICKED:', onset, 'event:', e);
                    console.log('ðŸ”¥ Target element:', e.target);
                    console.log('ðŸ”¥ Current element:', e.currentTarget);
                    toggleRow(onset, e);
                };
                onsetHeader.ondblclick = function(e) { 
                    console.log('ðŸ”¥ ONSET DOUBLE-CLICKED:', onset);
                    clearAllSelections(); 
                    e.preventDefault(); 
                };
                
                // EXTRA TEST: Add direct test handler
                onsetHeader.addEventListener('click', function(e) {
                    console.log('ðŸš¨ addEventListener ALSO working for:', onset);
                }, true);
                
                row.appendChild(onsetHeader);
                
                // Add blend cells for each vowel
                chartData.threeLetter.vowels.forEach(vowel => {
                    // Create the blend cell
                    const cell = document.createElement('div');
                    cell.className = `blend-cell ${vowel.type}-vowel-blend`;
                    cell.style.fontSize = "40px";
                    cell.style.padding = "15px";
                    cell.style.minWidth = "80px";
                    cell.style.minHeight = "80px";
                    
                    // Create the blend text without colored vowel
                    cell.innerHTML = `${onset}${vowel.symbol}`;
                    
                    // Store the full blend with diacritical mark for audio
                    cell.dataset.blend = onset + vowel.symbol;
                    cell.dataset.vowel = vowel.symbol;
                    cell.dataset.onset = onset;
                    
                    // Add click event for audio with special handling
                    cell.addEventListener('click', function() {
                        // Get the onset and vowel for special handling
                        const onsetValue = this.dataset.onset;
                        const vowelSymbol = this.dataset.vowel;
                        const fullBlend = this.dataset.blend;
                        
                        // Special direct word replacements for three-letter blends as requested
                        
                        // Long O replacements
                        if (fullBlend === 'twÅ') {
                            console.log("*** DIRECT: Playing 'toe' for twÅ ***");
                            speakDirectText('toe');
                            return;
                        }
                        
                        // Long U replacements
                        if (fullBlend === 'twÅ«') {
                            console.log("*** DIRECT: Playing 'two' for twÅ« ***");
                            speakDirectText('two');
                            return;
                        }
                        
                        // Short A replacements
                        if (fullBlend === 'twÄƒ') {
                            console.log("*** DIRECT: Playing 'twac' for twÄƒ ***");
                            speakDirectText('twac');
                            return;
                        }
                        if (fullBlend === 'blÄƒ') {
                            console.log("*** DIRECT: Playing 'bla' for blÄƒ ***");
                            speakDirectText('bla');
                            return;
                        }
                        if (fullBlend === 'clÄƒ') {
                            console.log("*** DIRECT: Playing 'cla' for clÄƒ with trick ***");
                            
                            // Use a trick with a manufactured word "clat" - browsers often 
                            // spell out short non-words but pronounce words correctly
                            const utterance = new SpeechSynthesisUtterance("clat");
                            utterance.rate = 0.9;  // Slightly slower for clarity
                            utterance.lang = 'en-US';
                            
                            // Cancel any existing speech
                            window.speechSynthesis.cancel();
                            
                            // Display what we're doing
                            document.getElementById('status-display').innerText = `Pronouncing: cla`;
                            
                            // Use the standard voice selection to match other sounds
                            const voices = window.speechSynthesis.getVoices();
                            if (voices.length > 0) {
                                // Apply the same voice selection logic used elsewhere
                                setVoiceAndSpeak(utterance, voices, 'clÄƒ', 'clat');
                            } else {
                                // If no voices available yet, just speak with default
                                window.speechSynthesis.speak(utterance);
                            }
                            
                            return;
                        }
                        
                        // Add handlers for other stubborn short 'Äƒ' blends
                        if (fullBlend === 'slÄƒ') {
                            console.log("*** DIRECT: Playing 'sla' for slÄƒ with trick ***");
                            const utterance = new SpeechSynthesisUtterance("slat");
                            utterance.rate = 0.9;
                            utterance.lang = 'en-US';
                            window.speechSynthesis.cancel();
                            document.getElementById('status-display').innerText = `Pronouncing: sla`;
                            window.speechSynthesis.speak(utterance);
                            return;
                        }
                        
                        if (fullBlend === 'brÄƒ') {
                            console.log("*** DIRECT: Playing 'bra' for brÄƒ with trick ***");
                            const utterance = new SpeechSynthesisUtterance("brat");
                            utterance.rate = 0.9;
                            utterance.lang = 'en-US';
                            window.speechSynthesis.cancel();
                            document.getElementById('status-display').innerText = `Pronouncing: bra`;
                            window.speechSynthesis.speak(utterance);
                            return;
                        }
                        
                        if (fullBlend === 'shÄƒ') {
                            console.log("*** DIRECT: Playing 'sha' for shÄƒ with trick ***");
                            const utterance = new SpeechSynthesisUtterance("shat");
                            utterance.rate = 0.9;
                            utterance.lang = 'en-US';
                            window.speechSynthesis.cancel();
                            document.getElementById('status-display').innerText = `Pronouncing: sha`;
                            window.speechSynthesis.speak(utterance);
                            return;
                        }
                        
                        if (fullBlend === 'jÄƒ') {
                            console.log("*** DIRECT: Playing 'ja' for jÄƒ with trick ***");
                            const utterance = new SpeechSynthesisUtterance("jat");
                            utterance.rate = 0.9;
                            utterance.lang = 'en-US';
                            window.speechSynthesis.cancel();
                            document.getElementById('status-display').innerText = `Pronouncing: ja`;
                            window.speechSynthesis.speak(utterance);
                            return;
                        }
                        
                        if (fullBlend === 'wÄƒ') {
                            console.log("*** DIRECT: Playing 'wa' for wÄƒ with trick ***");
                            const utterance = new SpeechSynthesisUtterance("wat");
                            utterance.rate = 0.9;
                            utterance.lang = 'en-US';
                            window.speechSynthesis.cancel();
                            document.getElementById('status-display').innerText = `Pronouncing: wa`;
                            window.speechSynthesis.speak(utterance);
                            return;
                        }
                        
                        // Short E replacements
                        if (fullBlend === 'twÄ•') {
                            console.log("*** DIRECT: Playing 'tweck' for twÄ• ***");
                            speakDirectText('tweck');
                            return;
                        }
                        if (fullBlend === 'phÄ•') {
                            console.log("*** DIRECT: Playing 'fetch' for phÄ• ***");
                            speakDirectText('fetch');
                            return;
                        }
                        if (fullBlend === 'quÄ•') {
                            console.log("*** DIRECT: Playing 'quest' for quÄ• ***");
                            speakDirectText('quest');
                            return;
                        }
                        if (fullBlend === 'clÄ•') {
                            console.log("*** DIRECT: Playing 'clep' for clÄ• ***");
                            speakDirectText('clep');
                            return;
                        }
                        if (fullBlend === 'grÄ•') {
                            console.log("*** DIRECT: Playing 'greb' for grÄ• ***");
                            speakDirectText('greb');
                            return;
                        }
                        
                        // Short I replacements
                        if (fullBlend === 'glÄ­') {
                            console.log("*** DIRECT: Playing 'glib' for glÄ­ ***");
                            speakDirectText('glib');
                            return;
                        }
                        if (fullBlend === 'frÄ­') {
                            console.log("*** DIRECT: Playing 'frit' for frÄ­ ***");
                            speakDirectText('frit');
                            return;
                        }
                        
                        // Short O replacements
                        if (fullBlend === 'chÅ') {
                            console.log("*** DIRECT: Playing 'chop' for chÅ ***");
                            speakDirectText('chop');
                            return;
                        }
                        if (fullBlend === 'smÅ') {
                            console.log("*** DIRECT: Playing 'smock' for smÅ ***");
                            speakDirectText('smock');
                            return;
                        }
                        if (fullBlend === 'twÅ') {
                            console.log("*** DIRECT: Playing 'twock' for twÅ ***");
                            speakDirectText('twock');
                            return;
                        }
                        
                        // Short U replacements
                        if (fullBlend === 'snÅ­') {
                            console.log("*** DIRECT: Playing 'snub' for snÅ­ ***");
                            speakDirectText('snub');
                            return;
                        }
                        if (fullBlend === 'whÅ­') {
                            console.log("*** DIRECT: Playing 'what' for whÅ­ ***");
                            speakDirectText('what');
                            return;
                        }
                        if (fullBlend === 'shÅ­') {
                            console.log("*** DIRECT: Playing 'shut' for shÅ­ ***");
                            speakDirectText('shut');
                            return;
                        }
                        
                        // Special handling for problematic blends
                        if (vowelSymbol === 'Ä“') {
                            if (onsetValue === 'j') {
                                console.log("*** DIRECT: Playing 'jee' sound ***");
                                speakDirectText('jee');
                                return;
                            }
                            if (onsetValue === 'n') {
                                console.log("*** DIRECT: Playing 'nee' sound ***");
                                speakDirectText('nee');
                                return;
                            }
                        }
                        
                        // Regular processing for other blends
                        playBlendAudio(this.dataset.blend);
                    });
                    
                    row.appendChild(cell);
                });
                
                chartElement.appendChild(row);
            });
        }

        // Set up tab switching
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remove active class from all tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    
                    // Add active class to clicked tab
                    this.classList.add('active');
                    
                    // Hide all tab content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Show corresponding tab content
                    const tabId = this.dataset.tab + '-content';
                    document.getElementById(tabId).classList.add('active');
                    
                    // Update practice state
                    practiceState.currentChartType = this.dataset.tab;
                    practiceState.currentVowel = null;
                    
                    // Reset active vowel button
                    document.querySelectorAll(`#${practiceState.currentChartType}-vowels .vowel-btn`).forEach(btn => {
                        btn.classList.remove('active');
                    });
                    document.querySelector(`#${practiceState.currentChartType}-vowels .vowel-btn:last-child`).classList.add('active');
                    
                    // Show all blends
                    filterChart(practiceState.currentChartType, null);
                });
            });
        }

        // Set up practice session
        function setupPractice() {
            const showAllBtn = document.getElementById('show-all-btn');
            const practiceRowBtn = document.getElementById('practice-row-btn');
            const practiceConsonantsBtn = document.getElementById('practice-consonants-btn');
            const practiceChartBtn = document.getElementById('practice-chart-btn');
            const modal = document.getElementById('practice-modal');
            const closeModal = document.querySelector('#practice-modal .close-modal');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const playBtn = document.getElementById('play-btn');
            const practiceModeSelect = document.getElementById('practice-mode');
            const timerSetting = document.getElementById('timer-setting');
            const practiceGoalInput = document.getElementById('practice-goal');
            
            // Show All Blends button (bottom)
            showAllBtn.addEventListener('click', function() {
                clearAllSelections();
                const activeTab = document.querySelector('.tab.active').dataset.tab;
                filterChart(activeTab, null);
                filterChartByConsonants(activeTab, null);
            });
            
            // Show All Blends buttons (top of each chart)
            const showAllTwoLetterBtn = document.getElementById('show-all-two-letter-btn');
            const showAllThreeLetterBtn = document.getElementById('show-all-three-letter-btn');
            
            showAllTwoLetterBtn.addEventListener('click', function() {
                clearAllSelections();
                filterChart('two-letter', null);
                filterChartByConsonants('two-letter', null);
            });
            
            showAllThreeLetterBtn.addEventListener('click', function() {
                clearAllSelections();
                filterChart('three-letter', null);
                filterChartByConsonants('three-letter', null);
            });
            
            // Practice vowel row button
            practiceRowBtn.addEventListener('click', function() {
                const activeTab = document.querySelector('.tab.active').dataset.tab;
                const activeVowels = document.querySelectorAll(`#${activeTab}-vowels .vowel-btn.active`);
                
                // Get selected vowels that have vowel data
                if (selectedVowels.length === 0) {
                    alert('Please click a vowel header to select vowels to practice. Hold Shift and click multiple headers for multi-vowel practice.');
                    return;
                }
                
                practiceState.currentChartType = activeTab;
                practiceState.currentVowel = selectedVowels.length === 1 ? selectedVowels[0] : selectedVowels;
                practiceState.currentConsonants = null; // Reset consonant selection
                practiceState.practicingVowelRow = true;
                practiceState.practicingConsonantColumn = false;
                
                // Goal feature removed
                
                preparePracticeSession();
                modal.style.display = 'block';
            });
            
            // Practice consonant columns button
            practiceConsonantsBtn.addEventListener('click', function() {
                const activeTab = document.querySelector('.tab.active').dataset.tab;
                // Update button text based on active tab
                if (activeTab === 'three-letter') {
                    this.textContent = 'Practice Selected Consonant Blends';
                } else {
                    this.textContent = 'Practice Selected Consonant Rows';
                }
                
                const activeConsonants = document.querySelectorAll(`#${activeTab}-consonants .consonant-btn.active`);
                
                if (selectedConsonants.length === 0) {
                    alert('Please click a consonant header to select consonants to practice. Hold Shift and click multiple headers for multi-consonant practice.');
                    return;
                }
                
                practiceState.currentChartType = activeTab;
                practiceState.currentVowel = null; // Reset vowel selection
                practiceState.currentConsonants = selectedConsonants.length === 1 ? selectedConsonants[0] : selectedConsonants;
                practiceState.practicingVowelRow = false;
                practiceState.practicingConsonantColumn = true;
                
                // Goal feature removed
                
                preparePracticeSession();
                modal.style.display = 'block';
            });
            
            // Practice entire chart button
            practiceChartBtn.addEventListener('click', function() {
                const activeTab = document.querySelector('.tab.active').dataset.tab;
                
                practiceState.currentChartType = activeTab;
                practiceState.currentVowel = null;
                practiceState.currentConsonants = null;
                practiceState.practicingVowelRow = false;
                practiceState.practicingConsonantColumn = false;
                
                // Goal feature removed
                
                preparePracticeSession();
                modal.style.display = 'block';
            });
            
            // Close modal
            closeModal.addEventListener('click', function() {
                stopPracticeSession();
                modal.style.display = 'none';
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === modal) {
                    stopPracticeSession();
                    modal.style.display = 'none';
                }
            });
            
            // Previous button
            prevBtn.addEventListener('click', function() {
                navigateBlends('prev');
            });
            
            // Next button
            nextBtn.addEventListener('click', function() {
                navigateBlends('next');
            });
            
            // Play sound button - when user explicitly requests audio
            playBtn.addEventListener('click', function() {
                const currentBlend = practiceState.blends[practiceState.currentIndex];
                playBlendAudio(currentBlend);
            });
            
            // Finish practice button
            document.getElementById('finish-practice-btn').addEventListener('click', function() {
                stopPracticeSession();
                modal.style.display = 'none';
            });
            
            // Practice mode change
            practiceModeSelect.addEventListener('change', function() {
                preparePracticeSession();
            });
            
            // Timer setting change
            timerSetting.addEventListener('change', function() {
                practiceState.timerValue = parseInt(this.value, 10);
                if (practiceState.isPlaying) {
                    stopTimer();
                    startTimer();
                }
            });
            
            // Flash mode toggle
            const flashModeCheckbox = document.getElementById('flash-mode');
            const ultraFlashModeCheckbox = document.getElementById('ultra-flash-mode');
            
            flashModeCheckbox.addEventListener('change', function() {
                practiceState.flashMode = this.checked;
                if (this.checked) {
                    // Disable Ultra Flash mode when Flash mode is enabled
                    ultraFlashModeCheckbox.checked = false;
                    practiceState.ultraFlashMode = false;
                }
                updateFlashModeState();
            });
            
            ultraFlashModeCheckbox.addEventListener('change', function() {
                practiceState.ultraFlashMode = this.checked;
                if (this.checked) {
                    // Disable Flash mode when Ultra Flash mode is enabled
                    flashModeCheckbox.checked = false;
                    practiceState.flashMode = false;
                }
                updateFlashModeState();
            });
            
            function updateFlashModeState() {
                const practiceContainer = document.querySelector('.practice-container');
                if (practiceState.flashMode || practiceState.ultraFlashMode) {
                    practiceContainer.classList.add('flash-active');
                } else {
                    practiceContainer.classList.remove('flash-active');
                    // Clear any existing flash timer
                    if (practiceState.flashTimer) {
                        clearTimeout(practiceState.flashTimer);
                        practiceState.flashTimer = null;
                    }
                }
            }
            
            // Goal setting change - removed
        }

        // Set up keyboard controls
        function setupKeyboardControls() {
            document.addEventListener('keydown', function(event) {
                // Only work if the practice modal is open
                if (document.getElementById('practice-modal').style.display !== 'block') {
                    return;
                }
                
                // Escape key to close the modal
                if (event.code === 'Escape') {
                    event.preventDefault();
                    stopPracticeSession();
                    document.getElementById('practice-modal').style.display = 'none';
                    return;
                }
                
                // Space key to advance to next blend
                if (event.code === 'Space') {
                    event.preventDefault();
                    if (practiceState.currentIndex < practiceState.blends.length - 1) {
                        navigateBlends('next');
                    }
                }
                
                // P key to play sound
                if (event.code === 'KeyP') {
                    event.preventDefault();
                    const currentBlend = practiceState.blends[practiceState.currentIndex];
                    playBlendAudio(currentBlend);
                }
                
                // Left arrow for previous
                if (event.code === 'ArrowLeft' && practiceState.currentIndex > 0) {
                    navigateBlends('prev');
                }
                
                // Right arrow for next
                if (event.code === 'ArrowRight' && practiceState.currentIndex < practiceState.blends.length - 1) {
                    navigateBlends('next');
                }
            });
        }

        // Prepare practice session
        function preparePracticeSession() {
            // Stop any existing timer
            stopPracticeSession();
            
            // Reset state
            practiceState.blends = [];
            practiceState.currentIndex = 0;
            practiceState.timerValue = parseInt(document.getElementById('timer-setting').value, 10);
            practiceState.isPlaying = true;
            practiceState.practiceCount = 0;
            
            // Initialize counter display
            const counterDisplay = document.getElementById('counter-display');
            if (counterDisplay) {
                counterDisplay.textContent = 'Blends practiced: 0';
            }
            
            const chartType = practiceState.currentChartType;
            const practiceMode = document.getElementById('practice-mode').value;
            
            // Get selected vowels
            let selectedVowels = [];
            
            // If we're practicing specific vowels (could be multiple)
            if (practiceState.currentVowel) {
                if (Array.isArray(practiceState.currentVowel)) {
                    // Multiple vowels selected
                    selectedVowels = practiceState.currentVowel;
                } else {
                    // Single vowel selected
                    selectedVowels = [practiceState.currentVowel];
                }
            } else {
                // No specific vowels selected, use all vowels
                if (chartType === 'two-letter') {
                    chartData.twoLetter.vowels.forEach(vowel => {
                        selectedVowels.push(vowel.symbol);
                    });
                } else {
                    chartData.threeLetter.vowels.forEach(vowel => {
                        selectedVowels.push(vowel.symbol);
                    });
                }
            }
            
            // Get selected consonants if we're practicing consonant columns
            let selectedConsonants = [];
            
            if (practiceState.practicingConsonantColumn && practiceState.currentConsonants) {
                if (Array.isArray(practiceState.currentConsonants)) {
                    // Multiple consonants selected
                    selectedConsonants = practiceState.currentConsonants;
                } else {
                    // Single consonant selected
                    selectedConsonants = [practiceState.currentConsonants];
                }
            } else {
                // No specific consonants selected, use all consonants
                if (chartType === 'two-letter') {
                    selectedConsonants = chartData.twoLetter.consonants;
                } else {
                    selectedConsonants = chartData.threeLetter.onsets;
                }
            }
            
            // Generate blends based on selected vowels and consonants
            if (chartType === 'two-letter') {
                selectedConsonants.forEach(consonant => {
                    selectedVowels.forEach(vowel => {
                        practiceState.blends.push(consonant + vowel);
                    });
                });
            } else { // three-letter
                selectedConsonants.forEach(onset => {
                    selectedVowels.forEach(vowel => {
                        practiceState.blends.push(onset + vowel);
                    });
                });
            }
            
            // Shuffle the blends if random mode is selected
            if (practiceMode === 'random') {
                shuffleArray(practiceState.blends);
            }
            
            // Display the first blend
            updateBlendDisplay();
            
            // Start the timer
            startTimer();
            
            // Enable/disable navigation buttons
            document.getElementById('prev-btn').disabled = true;
            document.getElementById('next-btn').disabled = practiceState.blends.length <= 1;
        }

        // Update the blend display
        function updateBlendDisplay(playAudio = false) {
            const blendDisplay = document.getElementById('blend-display');
            blendDisplay.innerHTML = '';
            
            if (practiceState.blends.length === 0) {
                blendDisplay.textContent = 'No blends to practice';
                return;
            }
            
            const currentBlend = practiceState.blends[practiceState.currentIndex];
            
            // Determine vowel type (long or short)
            let vowelType = 'long';
            
            // Get the vowel from the blend
            const vowel = currentBlend.match(/[ÄÄ“Ä«ÅÅ«ÄƒÄ•Ä­ÅÅ­]/);
            
            if (vowel) {
                const vowelChar = vowel[0];
                
                // Check if it's a short vowel (has breve accent)
                if (['Äƒ', 'Ä•', 'Ä­', 'Å', 'Å­'].includes(vowelChar)) {
                    vowelType = 'short';
                }
                
                // Update the blend display
                blendDisplay.className = `blend-display ${vowelType}-vowel-blend`;
                
                // Split the blend to highlight the vowel
                const parts = currentBlend.split(vowelChar);
                
                // Consonant part
                const consonantPart = document.createTextNode(parts[0]);
                blendDisplay.appendChild(consonantPart);
                
                // Vowel part
                const vowelSpan = document.createElement('span');
                vowelSpan.className = 'vowel';
                vowelSpan.textContent = vowelChar;
                blendDisplay.appendChild(vowelSpan);
                
                // Rest of the blend (if any)
                if (parts.length > 1 && parts[1]) {
                    const restPart = document.createTextNode(parts[1]);
                    blendDisplay.appendChild(restPart);
                }
            } else {
                // Fallback if no vowel is found
                blendDisplay.textContent = currentBlend;
            }
            
            // Only play audio if explicitly requested
            if (playAudio) {
                playBlendAudio(currentBlend);
            }
            
            // Implement Flash mode functionality
            if (practiceState.flashMode || practiceState.ultraFlashMode) {
                // Clear any existing flash timers
                if (practiceState.flashTimer) {
                    clearTimeout(practiceState.flashTimer);
                }
                
                // Show the blend immediately
                blendDisplay.style.opacity = '1';
                
                // Set a timer to hide the blend - 200ms for Ultra Flash, 300ms for regular Flash
                const flashDuration = practiceState.ultraFlashMode ? 200 : 300;
                practiceState.flashTimer = setTimeout(() => {
                    blendDisplay.style.opacity = '0';
                }, flashDuration);
            } else {
                // Ensure blend is visible if flash mode is disabled
                blendDisplay.style.opacity = '1';
            }
        }

        // Start timer
        function startTimer() {
            const timerDisplay = document.getElementById('timer-display');
            let timeLeft = practiceState.timerValue;
            
            timerDisplay.textContent = `Time remaining: ${timeLeft}s`;
            
            practiceState.timerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = `Time remaining: ${timeLeft}s`;
                
                if (timeLeft <= 0) {
                    clearInterval(practiceState.timerInterval);
                    timerDisplay.textContent = 'Time\'s up!';
                    
                    // Play the audio when time expires
                    const currentBlend = practiceState.blends[practiceState.currentIndex];
                    playBlendAudio(currentBlend);
                    
                    // No auto-advance - we want students to control when to move forward
                    // with the spacebar after they've heard the correct pronunciation
                }
            }, 1000);
        }

        // Stop timer
        function stopTimer() {
            if (practiceState.timerInterval) {
                clearInterval(practiceState.timerInterval);
                practiceState.timerInterval = null;
            }
        }

        // Stop practice session
        function stopPracticeSession() {
            stopTimer();
            practiceState.isPlaying = false;
            
            // Clear any existing flash timer
            if (practiceState.flashTimer) {
                clearTimeout(practiceState.flashTimer);
                practiceState.flashTimer = null;
            }
            
            // Save the practice count before resetting
            const totalCompleted = practiceState.practiceCount;
            
            // Reset practice count for next session
            practiceState.practiceCount = 0;
            
            // Reset the counter display
            const counterDisplay = document.getElementById('counter-display');
            if (counterDisplay) {
                counterDisplay.textContent = 'Blends practiced: 0';
            }
            
            // Show a completion message if student did any practice
            if (totalCompleted > 0) {
                let message = `Practice session complete! You practiced ${totalCompleted} blends.`;
                setTimeout(() => {
                    alert(message);
                }, 100);
            }
        }

        // Navigate through blends
        function navigateBlends(direction) {
            // Stop current timer
            stopTimer();
            
            // Clear any existing flash timer
            if (practiceState.flashTimer) {
                clearTimeout(practiceState.flashTimer);
                practiceState.flashTimer = null;
            }
            
            // Navigate
            if (direction === 'next' && practiceState.currentIndex < practiceState.blends.length - 1) {
                practiceState.currentIndex++;
                
                // If moving forward, increment the practice count
                practiceState.practiceCount++;
                
                // Goal feature removed
                updateGoalCounter();
            } else if (direction === 'prev' && practiceState.currentIndex > 0) {
                practiceState.currentIndex--;
            }
            
            // Update buttons state
            document.getElementById('prev-btn').disabled = practiceState.currentIndex === 0;
            document.getElementById('next-btn').disabled = practiceState.currentIndex === practiceState.blends.length - 1;
            
            // Update display
            updateBlendDisplay();
            
            // Restart timer
            startTimer();
        }
        
        // Update the blend counter display
        function updateGoalCounter() {
            // Update the counter display with the current practice count
            const counterDisplay = document.getElementById('counter-display');
            if (counterDisplay) {
                counterDisplay.textContent = `Blends practiced: ${practiceState.practiceCount}`;
            }
        }

        // Play audio for a blend
        function playBlendAudio(blend) {
            document.getElementById('status-display').innerText = 'Processing blend: ' + blend;
            console.log(`*** DEBUGGING: Starting to process blend: "${blend}" ***`);
            
            // Cancel any previous speech
            window.speechSynthesis.cancel();
            
            // Use our special handling function for jÄ“ sound
            if (blend === 'jÄ“') {
                console.log(`*** SPECIAL HANDLING for jÄ“ blend ***`);
                speakSpecialJeeSound();
                return;
            }
            
            // Use our special handling function for nÄ“ sound
            if (blend === 'nÄ“') {
                console.log(`*** SPECIAL HANDLING for nÄ“ blend ***`);
                speakSpecialNeeSound();
                return;
            }
            
            // Special handling for problematic Long I sounds
            if (blend.length === 2 && blend.charAt(1) === 'Ä«') {
                const consonant = blend.charAt(0);
                // Check if this is one of our problematic consonants
                // Make sure 'v' is included for special handling
                if (['b', 'c', 'g', 'm', 'n', 's', 'v', 'w'].includes(consonant)) {
                    console.log(`*** SPECIAL HANDLING for ${blend} Long I blend ***`);
                    speakLongISound(consonant);
                    return;
                }
            }
            
            // Special handling for problematic Long O sounds
            if (blend.length === 2 && blend.charAt(1) === 'Å') {
                const consonant = blend.charAt(0);
                // Check if this is one of our problematic consonants
                // Make sure 'f' and 'k' are included for special handling
                if (['f', 'h', 'k'].includes(consonant)) {
                    console.log(`*** SPECIAL HANDLING for ${blend} Long O blend ***`);
                    speakLongOSound(consonant);
                    return;
                }
            }
            
            // Special handling for problematic Long U sounds
            if (blend.length === 2 && blend.charAt(1) === 'Å«') {
                const consonant = blend.charAt(0);
                // Check if this is one of our problematic consonants
                // Added 't' and 'z' to handle tÅ«->two and zÅ«->zoo as requested
                // Added 'w' to handle wÅ«->woot as requested
                if (['n', 'p', 't', 'w', 'z'].includes(consonant)) {
                    console.log(`*** SPECIAL HANDLING for ${blend} Long U blend ***`);
                    speakLongUSound(consonant);
                    return;
                }
            }
            
            // Special handling for Short A sounds - added to fix Short A pronounced as Short U
            if (blend.includes('Äƒ')) {
                console.log(`*** SPECIAL HANDLING for ${blend} Short A blend ***`);
                
                // Use our override dictionary for the precise pronunciation
                let shortAWord = "";
                
                // Get the correct word with Short A sound based on specific blend
                if (blend === 'blÄƒ') shortAWord = "black";
                else if (blend === 'slÄƒ') shortAWord = "slat";
                else if (blend === 'brÄƒ') shortAWord = "brat";
                else if (blend === 'chÄƒ') shortAWord = "chat";
                else if (blend === 'shÄƒ') shortAWord = "shack";
                else if (blend === 'jÄƒ') shortAWord = "jam";
                else if (blend === 'wÄƒ') shortAWord = "wham";
                else if (blend === 'twÄƒ') shortAWord = "tan";
                // Three-letter trigraphs
                else if (blend === 'scÄƒ') shortAWord = "scat";
                else if (blend === 'stÄƒ') shortAWord = "stat";
                else if (blend === 'smÄƒ') shortAWord = "smat";
                else if (blend === 'snÄƒ') shortAWord = "snat";
                else if (blend === 'swÄƒ') shortAWord = "swam";
                else if (blend === 'thÄƒ') shortAWord = "that";
                else if (blend === 'phÄƒ') shortAWord = "phat";
                else if (blend === 'whÄƒ') shortAWord = "whap";
                else if (blend === 'quÄƒ') shortAWord = "quat";
                else {
                    // For other consonants, extract the consonant(s) and add "at" pattern
                    let consonant = blend.replace('Äƒ', '');
                    shortAWord = consonant + "at";
                }
                
                console.log(`Using word "${shortAWord}" for Short A blend "${blend}"`);
                
                // Force the pronunciation by speaking the full word
                speakWithForcedPronunciation(shortAWord);
                return;
            }
            
            // Special handling for Short E sounds - complete word replacements
            if (blend.includes('Ä•')) {
                console.log(`*** SPECIAL HANDLING for ${blend} Short E blend ***`);
                
                // Direct word replacement map for Short E
                let shortEWord = "";
                
                // Get the correct word with Short E sound based on specific blend
                if (blend === 'bÄ•') shortEWord = "bet";
                else if (blend === 'cÄ•') shortEWord = "cet";
                else if (blend === 'dÄ•') shortEWord = "det";
                else if (blend === 'fÄ•') shortEWord = "fetch";  // Changed to 'fetch' to fix letter-by-letter pronunciation
                else if (blend === 'gÄ•') shortEWord = "jet";  // Changed to 'jet' as requested
                else if (blend === 'rÄ•') shortEWord = "rep";  // Changed to 'rep' to fix letter-by-letter pronunciation
                else if (blend === 'vÄ•') shortEWord = "vet";
                else if (blend === 'blÄ•') shortEWord = "blet";
                else if (blend === 'clÄ•') shortEWord = "clet"; 
                else if (blend === 'crÄ•') shortEWord = "cref"; // Special fix for cre using ef ending
                else if (blend === 'drÄ•') shortEWord = "dret";
                else if (blend === 'flÄ•') shortEWord = "flef"; // Special fix for fle using ef ending
                else if (blend === 'frÄ•') shortEWord = "fret";
                else if (blend === 'glÄ•') shortEWord = "glef"; // Special fix for gle using ef ending
                else if (blend === 'grÄ•') shortEWord = "gret";
                else if (blend === 'plÄ•') shortEWord = "plet"; // Changed to et pattern
                else if (blend === 'prÄ•') shortEWord = "pret";
                else if (blend === 'scÄ•') shortEWord = "set"; // Changed from scet to set as requested
                else if (blend === 'schÄ•') shortEWord = "schet";
                else if (blend === 'scrÄ•') shortEWord = "scret";
                else if (blend === 'shÄ•') shortEWord = "shep"; // Changed from shet to shep as requested
                else if (blend === 'shrÄ•') shortEWord = "shret";
                else if (blend === 'skÄ•') shortEWord = "sket";
                else if (blend === 'slÄ•') shortEWord = "slef"; // Special fix for sle using ef ending
                else if (blend === 'smÄ•') shortEWord = "smet";
                else if (blend === 'snÄ•') shortEWord = "snef"; // Special fix for sne using ef ending
                else if (blend === 'spÄ•') shortEWord = "spet";
                else if (blend === 'splÄ•') shortEWord = "splet";
                else if (blend === 'sprÄ•') shortEWord = "spret";
                else if (blend === 'stÄ•') shortEWord = "stet";
                else if (blend === 'strÄ•') shortEWord = "stret";
                else if (blend === 'swÄ•') shortEWord = "swet"; // Changed to et pattern
                else if (blend === 'thÄ•') shortEWord = "thet";
                else if (blend === 'thrÄ•') shortEWord = "thret";
                else if (blend === 'trÄ•') shortEWord = "treb"; // Changed from tref to treb to avoid "trave" sound
                else if (blend === 'twÄ•') shortEWord = "twet"; // Kept as twet as requested
                else if (blend === 'whÄ•') shortEWord = "whet";
                else if (blend === 'wrÄ•') shortEWord = "wret";
                else if (blend === 'phÄ•') shortEWord = "fet"; // Changed from phet to fet as requested
                else if (blend === 'quÄ•') shortEWord = "quet"; // Changed to et pattern
                else {
                    // For any other consonants, add "et" ending for a clear Short E
                    let consonant = blend.replace('Ä•', '');
                    shortEWord = consonant + "et";
                }
                
                console.log(`Using word "${shortEWord}" for Short E blend "${blend}"`);
                
                // Force the pronunciation by speaking the full word
                speakWithForcedPronunciation(shortEWord);
                return;
            }
            
            // Special handling for Short O sounds - for "fÅ" to use "fought"
            if (blend.includes('Å')) {
                console.log(`*** SPECIAL HANDLING for ${blend} Short O blend ***`);
                
                // Direct word replacement map for Short O
                let shortOWord = "";
                
                // Get the correct word with Short O sound based on specific blend
                if (blend === 'fÅ') shortOWord = "fought";
                else if (blend === 'vÅ') shortOWord = "fought"; // Using "fought" for 'vÅ' sound as well
                else if (blend === 'mÅ') shortOWord = "mop"; // Using "mop" for 'mÅ' as requested
                else {
                    // For other consonants, extract the consonant(s) and add "ot" pattern
                    let consonant = blend.replace('Å', '');
                    shortOWord = consonant + "ot";
                }
                
                console.log(`Using word "${shortOWord}" for Short O blend "${blend}"`);
                
                // Force the pronunciation by speaking the full word
                speakWithForcedPronunciation(shortOWord);
                return;
            }
            
            // Special handling for Short U sounds
            if (blend.includes('Å­')) {
                console.log(`*** SPECIAL HANDLING for ${blend} Short U blend ***`);
                
                // Direct word replacement map for Short U
                let shortUWord = "";
                
                // Get the correct word with Short U sound based on specific blend
                // Consistently use "uh" endings for most blends to create uniformity
                if (blend === 'blÅ­') shortUWord = "bluh";
                else if (blend === 'flÅ­') shortUWord = "fluh";
                else if (blend === 'glÅ­') shortUWord = "gluh";
                else if (blend === 'plÅ­') shortUWord = "pluh";
                else if (blend === 'slÅ­') shortUWord = "sluh";
                // Special cases using "ut" endings as requested
                else if (blend === 'cÅ­') shortUWord = "cut";  // Using 'cut' instead of 'cuh'
                else if (blend === 'gÅ­') shortUWord = "gut";  // Using 'gut' instead of 'guh'
                else if (blend === 'jÅ­') shortUWord = "jut";  // Using 'jut' instead of 'jug'
                else if (blend === 'lÅ­') shortUWord = "lut";  // Using 'lut' instead of 'luh'
                else if (blend === 'rÅ­') shortUWord = "rut";  // Using 'rut' instead of 'ruh'
                else if (blend === 'sÅ­') shortUWord = "sup";  // Using "sup" - simple modification
                else if (blend === 'zÅ­') shortUWord = "such";  // Using "such" as requested
                // Other special cases
                else if (blend === 'qÅ­') shortUWord = "quack";
                else if (blend === 'wÅ­') shortUWord = "wuh"; 
                else if (blend === 'yÅ­') shortUWord = "yuh";
                else {
                    // For other consonants, extract the consonant(s) and add "uh" pattern
                    let consonant = blend.replace('Å­', '');
                    shortUWord = consonant + "uh";
                }
                
                console.log(`Using word "${shortUWord}" for Short U blend "${blend}"`);
                
                // Use a special function for short U sounds to make them less robotic
                speakShortUSound(shortUWord, blend);
                return;
            }
            
            // Special function for Short U sounds
            function speakShortUSound(text, blend) {
                console.log(`Speaking Short U pronunciation: "${text}"`);
                document.getElementById('status-display').innerText = 'Short U: ' + text;
                
                // Use speech synthesis
                if ('speechSynthesis' in window) {
                    // Cancel any ongoing speech
                    window.speechSynthesis.cancel();
                    
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.rate = 0.9;  // Slightly faster speech for more natural sound
                    utterance.pitch = 1.0;  // Normal pitch
                    
                    // Use a slight delay to ensure clean playback
                    setTimeout(() => {
                        window.speechSynthesis.speak(utterance);
                    }, 100);
                }
            
            }
            
            // Special handling for Short I sounds - complete word replacements
            if (blend.includes('Ä­')) {
                console.log(`*** SPECIAL HANDLING for ${blend} Short I blend ***`);
                
                // Direct word replacement map for Short I
                let shortIWord = "";
                
                // Improved logging for debugging
                console.log(`Debug - Blend being processed: "${blend}"`);
                console.log(`Debug - Is blend === 'mÄ­'? ${blend === 'mÄ­'}`);
                console.log(`Debug - Blend characters: ${Array.from(blend).map(c => c.charCodeAt(0)).join(', ')}`);
                console.log(`Debug - 'mÄ­' characters: ${Array.from('mÄ­').map(c => c.charCodeAt(0)).join(', ')}`);
                
                // SPECIAL HANDLING FOR MÄ¬ ONLY - MAXIMUM OVERRIDE
                if (blend.includes('m') && blend.includes('Ä­') && blend.length === 2) {
                    console.log(`**** SPECIALIZED MIT HANDLER ACTIVATED ****`);
                    
                    // Alternative: Create an audio element with a text-to-speech API
                    // This bypasses the standard speech synthesis and uses prerecorded audio
                    function playMitSound() {
                        // Use a simple audio approach to make sure it works
                        const audio = new Audio();
                        
                        // Three options to ensure at least one works
                        try {
                            // OPTION 1: Use built-in Text-to-Speech with a trick
                            const mitUtterance = new SpeechSynthesisUtterance("mitt");
                            mitUtterance.rate = 0.7;
                            mitUtterance.lang = 'en-US';
                            
                            // Clear queue
                            window.speechSynthesis.cancel();
                            
                            // Speak the sound
                            window.speechSynthesis.speak(mitUtterance);
                            
                            console.log("Using 'mitt' for pronunciation");
                        } catch (e) {
                            console.error("TTS failed:", e);
                        }
                    }
                    
                    // Display status
                    document.getElementById('status-display').innerText = `Pronouncing: mit`;
                    
                    // Run the special mit handler
                    playMitSound();
                    
                    return; // Exit early
                }
                // Get the correct word with Short I sound based on specific blend
                else if (blend === 'cÄ­') shortIWord = "sit";
                else if (blend === 'mÄ­') shortIWord = "mit"; // Already using "mit" as requested
                else if (blend === 'vÄ­') shortIWord = "Vick";
                else if (blend === 'blÄ­') shortIWord = "blit";
                else if (blend === 'clÄ­') shortIWord = "clit";
                else if (blend === 'drÄ­') shortIWord = "drit";
                else if (blend === 'flÄ­') shortIWord = "flit";
                else if (blend === 'frÄ­') shortIWord = "frit";
                else if (blend === 'glÄ­') shortIWord = "glit";
                else if (blend === 'grÄ­') shortIWord = "grit";
                else if (blend === 'plÄ­') shortIWord = "plit";
                else if (blend === 'prÄ­') shortIWord = "prit";
                else if (blend === 'scÄ­') shortIWord = "scit";
                else if (blend === 'schÄ­') shortIWord = "schit";
                else if (blend === 'scrÄ­') shortIWord = "scrit";
                else if (blend === 'shÄ­') shortIWord = "ship"; // Changed from shit to ship as requested
                else if (blend === 'shrÄ­') shortIWord = "shrit";
                else if (blend === 'skÄ­') shortIWord = "skit";
                else if (blend === 'slÄ­') shortIWord = "slit";
                else if (blend === 'smÄ­') shortIWord = "smit";
                else if (blend === 'snÄ­') shortIWord = "snit";
                else if (blend === 'spÄ­') shortIWord = "spit";
                else if (blend === 'splÄ­') shortIWord = "split";
                else if (blend === 'sprÄ­') shortIWord = "sprit";
                else if (blend === 'stÄ­') shortIWord = "stit";
                else if (blend === 'strÄ­') shortIWord = "strit";
                else if (blend === 'swÄ­') shortIWord = "swit";
                else if (blend === 'thÄ­') shortIWord = "thit";
                else if (blend === 'thrÄ­') shortIWord = "thrit";
                else if (blend === 'trÄ­') shortIWord = "trit";
                else if (blend === 'twÄ­') shortIWord = "twit";
                else if (blend === 'whÄ­') shortIWord = "whit";
                else if (blend === 'wrÄ­') shortIWord = "writ";
                else {
                    // For any other consonants, add "it" ending for a clear Short I
                    let consonant = blend.replace('Ä­', '');
                    shortIWord = consonant + "it";
                }
                
                console.log(`Using word "${shortIWord}" for Short I blend "${blend}"`);
                
                // Force the pronunciation by speaking the full word
                speakWithForcedPronunciation(shortIWord);
                return;
            }
            
            // Get the proper pronunciation
            let pronunciation = getPhoneticRepresentation(blend);
            console.log(`Initial pronunciation: "${pronunciation}" for blend "${blend}"`);
            
            // CRITICAL FIX: Force remove any "as in" text that might be in the pronunciation
            // Use global flag and be very aggressive with any pattern matching
            pronunciation = pronunciation.replace(/ as in.*/g, '').trim();
            pronunciation = pronunciation.replace(/\bas\sin\b.*$/g, '').trim();
            pronunciation = pronunciation.replace(/\s+as\s+in\s+.*$/g, '').trim();
            
            // Remove any spaces which cause spelling out behavior
            pronunciation = pronunciation.replace(/\s+/g, '');
            
            // Log the final cleaned pronunciation for verification
            console.log(`Final cleaned pronunciation: "${pronunciation}"`);
            document.getElementById('status-display').innerText = 'Pronunciation: ' + pronunciation;
            
            // Special function solely for "mit" pronunciation 
            function speakWithExtraPrecision(text) {
                console.log(`Speaking with extra precision: "${text}"`);
                document.getElementById('status-display').innerText = 'Special pronunciation: ' + text;
                
                if ('speechSynthesis' in window) {
                    // Make sure speech synthesis queue is clear
                    window.speechSynthesis.cancel();
                    
                    // Create a tailored utterance just for "mit"
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.rate = 0.7; // Slower for clarity
                    utterance.pitch = 1.0; // Natural pitch
                    utterance.lang = 'en-US';
                    utterance.volume = 1.0;
                    
                    // Get voices and select the best one for clear pronunciation
                    const voices = window.speechSynthesis.getVoices();
                    let preferredVoice = voices.find(voice => 
                        voice.name.includes('Google US English') || 
                        voice.name.includes('Microsoft David')
                    );
                    
                    if (preferredVoice) {
                        utterance.voice = preferredVoice;
                        console.log('Using voice for special mit sound: ' + preferredVoice.name);
                    }
                    
                    // Add a slight pause then speak "mit" as a whole word
                    setTimeout(() => {
                        window.speechSynthesis.speak(utterance);
                    }, 100);
                }
            }
            
            // Helper function for forced pronunciation
            function speakWithForcedPronunciation(text) {
                console.log(`Speaking forced pronunciation: "${text}"`);
                document.getElementById('status-display').innerText = 'Forced pronunciation: ' + text;
                
                // Special handling for h-ending words to prevent them from sounding like "clay" or "flay"
                if (text.endsWith('ih')) {
                    speakHEndingWord(text);
                    return;
                }
                
                // Use speech synthesis
                if ('speechSynthesis' in window) {
                    // Create a fresh utterance for each blend
                    const utterance = new SpeechSynthesisUtterance(text);
                    
                    // Set appropriate rate and pitch for male voice
                    utterance.rate = 0.8;
                    utterance.pitch = 0.9;
                    utterance.lang = 'en-US';
                    utterance.volume = 1.0;
                    
                    // Get available voices
                    let voices = window.speechSynthesis.getVoices();
                    
                    // If voices are not available yet, wait for them
                    if (voices.length === 0) {
                        window.speechSynthesis.onvoiceschanged = function() {
                            voices = window.speechSynthesis.getVoices();
                            setVoiceAndSpeak(utterance, voices, blend, text);
                        };
                    } else {
                        setVoiceAndSpeak(utterance, voices, blend, text);
                    }
                }
            }
            
            // Special function for h-ending words to make sure they sound like "i" not "ay"
            function speakHEndingWord(text) {
                console.log(`Special handling for h-ending word: "${text}"`);
                document.getElementById('status-display').innerText = 'Special h-ending: ' + text;
                
                if ('speechSynthesis' in window) {
                    // Cancel any ongoing speech
                    window.speechSynthesis.cancel();
                    
                    // For Short I sounds, we'll use a different approach
                    if (text.endsWith('ih')) {
                        // Create a special utterance for Short I with 'ih' ending
                        const utterance = new SpeechSynthesisUtterance(text);
                        utterance.rate = 0.6; // Slower for clarity
                        utterance.pitch = 0.9; // Lower pitch helps with Short I sounds
                        utterance.volume = 1.0;
                        
                        // Speak with a slight delay
                        setTimeout(() => {
                            window.speechSynthesis.speak(utterance);
                        }, 100);
                    } else {
                        // Create separate utterances to force correct pronunciation
                        // Extract the consonant part (everything before 'eh')
                        const consonantPart = text.substring(0, text.length - 2);
                        
                        // First speak consonant + "e" with specific settings
                        const firstPart = new SpeechSynthesisUtterance(consonantPart + "i");
                        firstPart.rate = 0.7; // Slower for clarity
                        firstPart.pitch = 1.1; // Slightly higher pitch to emphasize short I sound
                        
                        // Speak the first part
                        window.speechSynthesis.speak(firstPart);
                    }
                }
            }
            
            // Special handling for Short I sounds - complete word replacements
            if (blend.includes('Ä­')) {
                console.log(`*** SPECIAL HANDLING for ${blend} Short I blend ***`);
                
                // Direct word replacement map for Short I
                let shortIWord = "";
                
                // Handle specific blends with optimized words
                if (blend === 'bÄ­') shortIWord = 'bit';
                else if (blend === 'cÄ­') shortIWord = 'kit';
                else if (blend === 'dÄ­') shortIWord = 'did';
                else if (blend === 'fÄ­') shortIWord = 'fit';
                else if (blend === 'gÄ­') shortIWord = 'jit';  // Changed to 'jit' as requested
                else if (blend === 'hÄ­') shortIWord = 'hit';
                else if (blend === 'jÄ­') shortIWord = 'jif';
                else if (blend === 'kÄ­') shortIWord = 'kit';
                else if (blend === 'lÄ­') shortIWord = 'lit';
                else if (blend === 'mÄ­') shortIWord = 'mit';
                else if (blend === 'nÄ­') shortIWord = 'nit';
                else if (blend === 'pÄ­') shortIWord = 'pit';
                else if (blend === 'rÄ­') shortIWord = 'rip';  // Changed to 'rip' for proper blend sound
                else if (blend === 'sÄ­') shortIWord = 'sit';
                else if (blend === 'tÄ­') shortIWord = 'tit';
                else if (blend === 'vÄ­') shortIWord = 'vit';
                else if (blend === 'wÄ­') shortIWord = 'wit';
                else if (blend === 'yÄ­') shortIWord = 'yip';
                else if (blend === 'zÄ­') shortIWord = 'zip';
                else {
                    // For any other blends not in our map
                    const consonant = blend.charAt(0);
                    shortIWord = consonant + 'it';
                }
                
                console.log(`Using word "${shortIWord}" for Short I blend "${blend}"`);
                
                // Use the speakWithDetailedVoiceSettings function for better articulation
                speakWithDetailedVoiceSettings(shortIWord, blend);
                return;
            }
            
            // Use speech synthesis
            if ('speechSynthesis' in window) {
                // Create a fresh utterance for each blend
                const utterance = new SpeechSynthesisUtterance(pronunciation);
                
                // Set appropriate rate based on vowel type
                if (blend.match(/[ÄÄ“Ä«ÅÅ«]/)) {
                    // Long vowels - normal rate
                    utterance.rate = 0.7;
                } else {
                    // Short vowels - slower rate for better articulation
                    utterance.rate = 0.6;
                }
                
                // Different pitch for long vs short vowels
                if (blend.match(/[ÄÄ“Ä«ÅÅ«]/)) {
                    // Long vowels - slightly higher pitch
                    utterance.pitch = 1.1;
                } else {
                    // Short vowels - slightly lower pitch
                    utterance.pitch = 0.95;
                }
                
                utterance.lang = 'en-US';
                
                // Ensure maximum volume for better audibility
                utterance.volume = 1.0;
                
                // Make sure it only plays once and prevent repeats
                utterance.onend = function() {
                    document.getElementById('status-display').innerText = 'Finished playing: ' + pronunciation;
                };
                
                // Get available voices
                let voices = window.speechSynthesis.getVoices();
                
                // If voices are not available yet, wait for them
                if (voices.length === 0) {
                    window.speechSynthesis.onvoiceschanged = function() {
                        voices = window.speechSynthesis.getVoices();
                        setVoiceAndSpeak(utterance, voices, blend, pronunciation);
                    };
                } else {
                    setVoiceAndSpeak(utterance, voices, blend, pronunciation);
                }
            } else {
                document.getElementById('status-display').innerText = 'Speech synthesis not supported';
                alert('Speech synthesis is not supported in your browser. Please try using Firefox or Chrome.');
            }
        }

        // Set voice and speak with improved voice selection for Firefox compatibility
        function setVoiceAndSpeak(utterance, voices, blend, pronunciation) {
            // Log all available voices for debugging
            console.log('Available voices:', voices.map(v => v.name).join(', '));
            
            // Top-tier priority voices for phonetic clarity - male voices
            let preferredVoice = voices.find(voice => 
                voice.name.includes('Google UK English Male') || // Google's male voice is excellent for phonetics
                voice.name.includes('Google US English Male') || // Google's male voice
                voice.name.includes('Microsoft David') || // Microsoft's David voice
                voice.name.includes('Microsoft Mark') || // Microsoft's Mark voice
                (voice.name.includes('English') && voice.name.includes('Male'))
            );
            
            // Second tier - explicitly male voices
            if (!preferredVoice) {
                preferredVoice = voices.find(voice => 
                    voice.name.toLowerCase().includes('male') || 
                    voice.name.toLowerCase().includes('man')
                );
            }
            
            // Third tier - common male names with good articulation
            if (!preferredVoice) {
                preferredVoice = voices.find(voice => 
                    voice.name.includes('David') ||
                    voice.name.includes('Mark') ||
                    voice.name.includes('Tom') ||
                    voice.name.includes('Daniel') ||
                    voice.name.includes('Alex') ||
                    voice.name.includes('James') ||
                    voice.name.includes('John') ||
                    voice.name.includes('Peter')
                );
            }
            
            // Firefox-specific voices that work well with phonetics
            if (!preferredVoice) {
                preferredVoice = voices.find(voice => 
                    voice.name.includes('English') && voice.name.includes('US') && 
                    !voice.name.includes('Microsoft') && // Skip Microsoft voices which can be problematic in Firefox
                    (voice.name.toLowerCase().includes('male') || // Prefer explicitly male voices
                     !voice.name.toLowerCase().includes('female')) // Or at least not female voices
                );
            }
            
            // Other high-quality voices that aren't explicitly female
            if (!preferredVoice) {
                preferredVoice = voices.find(voice => 
                    (voice.name.includes('Google US English') ||
                    voice.name.includes('English United States') ||
                    voice.name.includes('Alex')) &&
                    !voice.name.toLowerCase().includes('female')
                );
            }
            
            // Fall back to any English voice if needed
            if (!preferredVoice) {
                preferredVoice = voices.find(voice => 
                    voice.lang.includes('en-US') || 
                    voice.lang.includes('en_US') || 
                    voice.lang.includes('en-GB')
                );
            }
            
            // If we have a preferred voice, use it
            if (preferredVoice) {
                utterance.voice = preferredVoice;
                console.log('Using voice: ' + preferredVoice.name);
            } else if (voices.length > 0) {
                // If no matching voice but voices exist, use the first available one
                utterance.voice = voices[0];
                console.log('Falling back to first available voice: ' + voices[0].name);
            }
            
            // Ensure we're using the correct language
            utterance.lang = 'en-US';
            
            // Set the utterance text directly - DON'T USE A VARIABLE
            utterance.text = pronunciation;
            
            // Fine-tune voice parameters based on the selected voice for male voices
            if (utterance.voice) {
                // Adjust pitch for male voices specifically
                const isMaleVoice = 
                    utterance.voice.name.toLowerCase().includes('male') || 
                    utterance.voice.name.includes('David') ||
                    utterance.voice.name.includes('Mark') ||
                    utterance.voice.name.includes('Daniel') ||
                    utterance.voice.name.includes('Thomas');
                
                if (utterance.voice.name.includes('Google') && isMaleVoice) {
                    // Male Google voices work well with a slightly lower pitch
                    utterance.pitch = 0.95;
                    utterance.rate = 0.8;  // Slightly slower for clarity
                } else if (utterance.voice.name.includes('Microsoft') && isMaleVoice) {
                    // Microsoft male voices need a more neutral pitch
                    utterance.pitch = 1.0;
                    utterance.rate = 0.85;
                } else if (isMaleVoice) {
                    // Default for other male voices
                    utterance.pitch = 0.9;
                    utterance.rate = 0.8;
                } else {
                    // For any non-male voices that might be used as fallback
                    utterance.pitch = 0.85;  // Lower pitch to sound more masculine
                    utterance.rate = 0.8;    // Slower rate for clarity
                }
            } else {
                // No voice selected, use standard parameters for male sound
                utterance.pitch = 0.9;
                utterance.rate = 0.8;
            }
            
            // Log the final voice settings for debugging
            console.log(`Voice settings: voice=${utterance.voice?.name}, pitch=${utterance.pitch}, rate=${utterance.rate}`);
            
            // Debugging counter
            if (!window.debugCounter) window.debugCounter = 0;
            window.debugCounter++;
            
            // Add a distinguishing number to help debug
            document.getElementById('status-display').innerText = 'Playing: ' + pronunciation + ' (' + window.debugCounter + ') with voice: ' + 
                (utterance.voice ? utterance.voice.name : 'Default');
            
            // Cancel any existing speech to prevent overlapping
            window.speechSynthesis.cancel();
            
            // Speak the blend with a slight delay to ensure the browser is ready
            setTimeout(() => {
                try {
                    window.speechSynthesis.speak(utterance);
                    
                    // Set a backup timer in case speech synthesis fails silently
                    setTimeout(() => {
                        const isSpeaking = window.speechSynthesis.speaking;
                        if (!isSpeaking) {
                            console.log('Speech synthesis may have failed silently, trying again...');
                            window.speechSynthesis.cancel();
                            window.speechSynthesis.speak(utterance);
                        }
                    }, 500);
                } catch (e) {
                    document.getElementById('status-display').innerText = 'Speech error: ' + e.message;
                    console.error('Speech synthesis error:', e);
                }
            }, 100);
        }

        // Speak using phonemic transcription for better pronunciation accuracy
        function speakDirectText(text) {
            console.log(`Speaking direct text with phonemic approach: "${text}"`);
            document.getElementById('status-display').innerText = 'Direct pronunciation: ' + text;
            
            // Create a map of phonemic spellings for problematic sounds
            const phoneticMap = {
                'jee': 'JH IY1', // Phonemic transcription for "jee"
                'nee': 'N IY1',   // Phonemic transcription for "nee"
                'cla': 'K L AA1'  // Phonemic transcription for "cla"
            };
            
            // Get phonemic transcription if available
            const phonemicText = phoneticMap[text.toLowerCase()] || text;
            
            // Use speech synthesis with phonemic approach
            if ('speechSynthesis' in window) {
                // Cancel any existing speech
                window.speechSynthesis.cancel();
                
                // Choose strategy based on the specific blend
                if (text.toLowerCase() === 'jee') {
                    // For "jee" sound
                    speakSpecialJeeSound();
                } else if (text.toLowerCase() === 'nee') {
                    // For "nee" sound
                    speakSpecialNeeSound();
                } else {
                    // Default handling with phonemic transcription
                    speakWithPhonemicTranscription(phonemicText);
                }
            } else {
                console.error('Speech synthesis not supported');
                alert('Speech synthesis is not supported in your browser.');
            }
        }
        
        // Special "jee" sound using very specific approach
        function speakSpecialJeeSound() {
            console.log("Using special technique for JEE sound");
            
            // Instead of trying to blend two separate sounds, use a known working pronunciation pattern
            // Using "jeep" without the final "p" sound works better than breaking into parts
            const utterance = new SpeechSynthesisUtterance("jeep");
            
            // Configure the voice
            utterance.lang = 'en-US';
            utterance.volume = 1.0;
            utterance.rate = 0.7;  // Slightly slower for clarity
            utterance.pitch = 1.0;
            
            // Get voices and prioritize specific ones known to work well
            const voices = window.speechSynthesis.getVoices();
            
            // Find an appropriate voice, prioritizing Google voices which are typically clearer
            const preferredVoice = voices.find(voice => 
                voice.name.includes('Google US English') || 
                voice.name.includes('Microsoft David') ||
                voice.name.includes('Male') ||
                voice.name.includes('male')
            );
            
            if (preferredVoice) {
                utterance.voice = preferredVoice;
                console.log('Using voice for jee sound: ' + preferredVoice.name);
            }
            
            // Set a callback to cut off the final "p" sound
            let hasSpoken = false;
            utterance.onmark = function(event) {
                if (!hasSpoken) {
                    // Cancel after the vowel sound but before the final consonant
                    setTimeout(() => {
                        window.speechSynthesis.cancel();
                        hasSpoken = true;
                    }, 300); // Timing adjusted to cut off just before the "p" sound
                }
            };
            
            // Speak
            setTimeout(() => {
                window.speechSynthesis.speak(utterance);
                console.log("Speaking 'jeep' with early cutoff");
            }, 100);
        }
        
        // Special "nee" sound using pronunciation of "knee"
        function speakSpecialNeeSound() {
            console.log("Using 'knee' pronunciation for NEE sound");
            
            // Try using "knee" with very careful pronunciation settings
            const utterance = new SpeechSynthesisUtterance("knee");
            
            // Configure for maximum clarity
            utterance.lang = 'en-US';
            utterance.volume = 1.0;
            utterance.rate = 0.7;  // Slightly slower than normal
            utterance.pitch = 0.9; // Slightly deeper voice
            
            // Get voices and prioritize specific ones known to work well
            const voices = window.speechSynthesis.getVoices();
            
            // Try specific voices that are known to pronounce "knee" correctly
            let preferredVoice = null;
            
            // Try to find Google voices first as they tend to be clearer
            preferredVoice = voices.find(voice => 
                voice.name.includes('Google US English')
            );
            
            // If no Google voice, try Microsoft voices
            if (!preferredVoice) {
                preferredVoice = voices.find(voice => 
                    voice.name.includes('Microsoft')
                );
            }
            
            // If still no preferred voice, try any male voice
            if (!preferredVoice) {
                preferredVoice = voices.find(voice => 
                    voice.name.toLowerCase().includes('male')
                );
            }
            
            // Apply the voice if found
            if (preferredVoice) {
                utterance.voice = preferredVoice;
                console.log('Using voice for knee sound: ' + preferredVoice.name);
            }
            
            // Special handling for voice - we'll try to emphasize the word
            // by adding a slight pause before it
            const pauseUtterance = new SpeechSynthesisUtterance(".");
            pauseUtterance.volume = 0;
            pauseUtterance.rate = 0.1;
            
            // Update status display
            document.getElementById('status-display').innerText = 'Pronouncing: nee';
            
            // Speak after canceling any existing speech
            window.speechSynthesis.cancel();
            
            // Speak the word with a slight initial pause
            setTimeout(() => {
                window.speechSynthesis.speak(pauseUtterance);
                
                // Speak the actual word after the pause
                setTimeout(() => {
                    window.speechSynthesis.speak(utterance);
                    console.log("Speaking 'knee'");
                }, 50);
            }, 100);
        }
        
        // Special handling for Long I sounds - fixes "bi, ci, mi, ni, si, vi, wi" pronunciations
        function speakLongISound(consonant) {
            console.log(`Using special handling for Long I sound: ${consonant}Ä«`);
            
            // Different word templates to use for Long I sounds
            const wordTemplates = {
                'b': 'buy',
                'c': 'sigh',  // Using soft C (sounds like 's') for 'cÄ«' sound
                'g': 'jive',  // Updated to 'jive' as requested
                'm': 'my',
                'n': 'nigh',
                's': 'sigh',
                'v': 'vipe',  // Changed to 'vipe' for better long I sound
                'w': 'why'
            };
            
            // Get the appropriate word template or use a generic one
            const wordTemplate = wordTemplates[consonant] || consonant + 'ine';
            
            // Create and configure utterance
            const utterance = new SpeechSynthesisUtterance(wordTemplate);
            utterance.lang = 'en-US';
            utterance.volume = 1.0;
            utterance.rate = 0.7;  // Slower for clarity
            utterance.pitch = 0.9;
            
            // Special handling for 'v' to emphasize the long I sound
            if (consonant === 'v') {
                utterance.rate = 0.65;  // Even slower for better 'vite' pronunciation
                utterance.pitch = 1.0;  // Higher pitch for long I sound
                console.log("Using enhanced pronunciation for vÄ« â†’ vite with long I sound");
            }
            
            // Get voices and select the best one
            const voices = window.speechSynthesis.getVoices();
            let preferredVoice = voices.find(voice => 
                voice.name.includes('Google US English') || 
                voice.name.includes('Microsoft') || 
                voice.name.toLowerCase().includes('male')
            );
            
            if (preferredVoice) {
                utterance.voice = preferredVoice;
                console.log('Using voice for Long I sound: ' + preferredVoice.name);
            }
            
            // Update status display
            document.getElementById('status-display').innerText = `Pronouncing: ${consonant}Ä«`;
            
            // Cancel any existing speech
            window.speechSynthesis.cancel();
            
            // Add a slight pause before speaking
            setTimeout(() => {
                window.speechSynthesis.speak(utterance);
                console.log(`Speaking '${wordTemplate}' for ${consonant}Ä« sound`);
            }, 100);
        }
        
        // Special handling for Long U sounds - fixes "nÅ«" and "pÅ«" pronunciations
        function speakLongUSound(consonant) {
            console.log(`Using special handling for Long U sound: ${consonant}Å«`);
            
            // Special handling for "pÅ«" which needs extra treatment
            if (consonant === 'p') {
                // Use special technique for "pÅ«" sound
                console.log('Using advanced handling for pÅ« sound');
                
                // Create special utterance for "pÅ«"
                // Use "pew" as suggested for better pronunciation
                const utterance = new SpeechSynthesisUtterance("pew");
                utterance.lang = 'en-US';
                utterance.volume = 1.0;
                utterance.rate = 0.75;  // Moderate speed to get the proper 'ew' sound
                utterance.pitch = 1.0;
                
                // Get voices and select the best one with emphasis on male voices
                const voices = window.speechSynthesis.getVoices();
                let preferredVoice = voices.find(voice => 
                    voice.name.includes('Google US English') || 
                    voice.name.includes('Microsoft David') || 
                    voice.name.toLowerCase().includes('male')
                );
                
                if (preferredVoice) {
                    utterance.voice = preferredVoice;
                    console.log('Using voice for pÅ« sound: ' + preferredVoice.name);
                }
                
                // Update status display
                document.getElementById('status-display').innerText = `Pronouncing: pÅ«`;
                
                // Cancel any existing speech
                window.speechSynthesis.cancel();
                
                // Add a slight pause before speaking
                setTimeout(() => {
                    window.speechSynthesis.speak(utterance);
                    console.log(`Special handling for pÅ« sound using 'pew'`);
                }, 100);
                
                return;
            }
            
            // Special word templates for other Long U sounds
            const wordTemplates = {
                'n': 'new',  // Using "new" for "nÅ«" instead of "noo"
                't': 'two',  // Using "two" for "tÅ«" as requested
                'w': 'woot', // Using "woot" for "wÅ«" as requested
                'z': 'zoo'   // Using "zoo" for "zÅ«" as requested
            };
            
            // Get the appropriate word template
            const wordTemplate = wordTemplates[consonant] || consonant + 'ew';
            
            // Create and configure utterance
            const utterance = new SpeechSynthesisUtterance(wordTemplate);
            utterance.lang = 'en-US';
            utterance.volume = 1.0;
            utterance.rate = 0.65;  // Slower for clarity
            utterance.pitch = 0.9;
            
            // Get voices and select the best one
            const voices = window.speechSynthesis.getVoices();
            let preferredVoice = voices.find(voice => 
                voice.name.includes('Google US English') || 
                voice.name.includes('Microsoft David') || 
                voice.name.toLowerCase().includes('male')
            );
            
            if (preferredVoice) {
                utterance.voice = preferredVoice;
                console.log('Using voice for Long U sound: ' + preferredVoice.name);
            }
            
            // Update status display
            document.getElementById('status-display').innerText = `Pronouncing: ${consonant}Å«`;
            
            // Cancel any existing speech
            window.speechSynthesis.cancel();
            
            // Add a slight pause before speaking
            setTimeout(() => {
                window.speechSynthesis.speak(utterance);
                console.log(`Speaking '${wordTemplate}' for ${consonant}Å« sound`);
            }, 100);
        }
        
        // Special handling for Long O sounds with issues - fixes "fÅ", "hÅ", "kÅ" pronunciations
        function speakLongOSound(consonant) {
            console.log(`Using special handling for Long O sound: ${consonant}Å`);
            
            // Special handling for "fÅ" and "kÅ" which need extra treatment
            if (consonant === 'f') {
                // Use special technique for "fÅ" using "fote" for proper long O sound
                console.log('Using advanced handling for fÅ sound');
                
                // Create special utterance for "fÅ"
                const utterance = new SpeechSynthesisUtterance("fote");
                utterance.lang = 'en-US';
                utterance.volume = 1.0;
                utterance.rate = 0.65;  // Slower for clarity
                utterance.pitch = 0.9;
                
                // Get voices and select the best one with emphasis on male voices
                const voices = window.speechSynthesis.getVoices();
                let preferredVoice = voices.find(voice => 
                    voice.name.includes('Google US English') || 
                    voice.name.includes('Microsoft David') || 
                    voice.name.toLowerCase().includes('male')
                );
                
                if (preferredVoice) {
                    utterance.voice = preferredVoice;
                    console.log('Using voice for fÅ sound: ' + preferredVoice.name);
                }
                
                // Update status display
                document.getElementById('status-display').innerText = `Pronouncing: fÅ`;
                
                // Cancel any existing speech
                window.speechSynthesis.cancel();
                
                // Add a slight pause before speaking
                setTimeout(() => {
                    window.speechSynthesis.speak(utterance);
                    console.log(`Special handling for fÅ sound using 'foam'`);
                }, 100);
                
                return;
            }
            else if (consonant === 'k') {
                // Use special technique for "kÅ" to prevent the "uh" sound at the end
                console.log('Using advanced handling for kÅ sound');
                
                // Create special utterance for "kÅ"
                const utterance = new SpeechSynthesisUtterance("coat");
                utterance.lang = 'en-US';
                utterance.volume = 1.0;
                utterance.rate = 0.65;  // Slower for clarity
                utterance.pitch = 0.9;
                
                // Get voices and select the best one with emphasis on male voices
                const voices = window.speechSynthesis.getVoices();
                let preferredVoice = voices.find(voice => 
                    voice.name.includes('Google US English') || 
                    voice.name.includes('Microsoft David') || 
                    voice.name.toLowerCase().includes('male')
                );
                
                if (preferredVoice) {
                    utterance.voice = preferredVoice;
                    console.log('Using voice for kÅ sound: ' + preferredVoice.name);
                }
                
                // Update status display
                document.getElementById('status-display').innerText = `Pronouncing: kÅ`;
                
                // Cancel any existing speech
                window.speechSynthesis.cancel();
                
                // Add a slight pause before speaking
                setTimeout(() => {
                    window.speechSynthesis.speak(utterance);
                    console.log(`Special handling for kÅ sound using 'coat'`);
                }, 100);
                
                return;
            }
            
            // Different word templates to use for other problematic Long O sounds
            const wordTemplates = {
                'h': 'hoe'   // Ensure "hoe" is properly pronounced
            };
            
            // Get the appropriate word template
            const wordTemplate = wordTemplates[consonant] || consonant + 'oe';
            
            // Create and configure utterance
            const utterance = new SpeechSynthesisUtterance(wordTemplate);
            utterance.lang = 'en-US';
            utterance.volume = 1.0;
            utterance.rate = 0.65;  // Slower for clarity
            utterance.pitch = 0.9;
            
            // Get voices and select the best one
            const voices = window.speechSynthesis.getVoices();
            let preferredVoice = voices.find(voice => 
                voice.name.includes('Google US English') || 
                voice.name.includes('Microsoft') || 
                voice.name.toLowerCase().includes('male')
            );
            
            if (preferredVoice) {
                utterance.voice = preferredVoice;
                console.log('Using voice for Long O sound: ' + preferredVoice.name);
            }
            
            // Update status display
            document.getElementById('status-display').innerText = `Pronouncing: ${consonant}Å`;
            
            // Cancel any existing speech
            window.speechSynthesis.cancel();
            
            // Add a slight pause before speaking
            setTimeout(() => {
                window.speechSynthesis.speak(utterance);
                console.log(`Speaking '${wordTemplate}' for ${consonant}Å sound`);
            }, 100);
        }
        
        // Special handling for jÄ“ sound (like in "jeep")
        function speakSpecialJeeSound() {
            console.log('Using special handling for jÄ“ sound');
            
            // Create utterance with the word "jeep"
            const utterance = new SpeechSynthesisUtterance("jeep");
            utterance.lang = 'en-US';
            utterance.volume = 1.0;
            utterance.rate = 0.7;  // Slower for clarity
            utterance.pitch = 0.9;
            
            // Get voices and select the best one
            const voices = window.speechSynthesis.getVoices();
            let preferredVoice = voices.find(voice => 
                voice.name.includes('Google US English') || 
                voice.name.includes('Microsoft') || 
                voice.name.toLowerCase().includes('male')
            );
            
            if (preferredVoice) {
                utterance.voice = preferredVoice;
                console.log('Using voice for jÄ“ sound: ' + preferredVoice.name);
            }
            
            // Update status display
            document.getElementById('status-display').innerText = 'Pronouncing: jÄ“';
            
            // Cancel any existing speech
            window.speechSynthesis.cancel();
            
            // Add a slight pause before speaking
            setTimeout(() => {
                window.speechSynthesis.speak(utterance);
                console.log('Speaking "jeep" for jÄ“ sound');
            }, 100);
        }
        
        // Special handling for nÄ“ sound (like in "knee")
        function speakSpecialNeeSound() {
            console.log('Using special handling for nÄ“ sound');
            
            // Create utterance with the word "knee"
            const utterance = new SpeechSynthesisUtterance("knee");
            utterance.lang = 'en-US';
            utterance.volume = 1.0;
            utterance.rate = 0.7;  // Slower for clarity
            utterance.pitch = 0.9;
            
            // Get voices and select the best one
            const voices = window.speechSynthesis.getVoices();
            let preferredVoice = voices.find(voice => 
                voice.name.includes('Google US English') || 
                voice.name.includes('Microsoft') || 
                voice.name.toLowerCase().includes('male')
            );
            
            if (preferredVoice) {
                utterance.voice = preferredVoice;
                console.log('Using voice for nÄ“ sound: ' + preferredVoice.name);
            }
            
            // Update status display
            document.getElementById('status-display').innerText = 'Pronouncing: nÄ“';
            
            // Cancel any existing speech
            window.speechSynthesis.cancel();
            
            // Add a slight pause before speaking
            setTimeout(() => {
                window.speechSynthesis.speak(utterance);
                console.log('Speaking "knee" for nÄ“ sound');
            }, 100);
        }
        
        // Configure an utterance to use male voice
        function configureForMaleVoice(utterance) {
            utterance.lang = 'en-US';
            utterance.volume = 1.0;
            
            // Get available voices
            let voices = window.speechSynthesis.getVoices();
            
            // Find a male voice
            let maleVoice = voices.find(voice => 
                voice.name.includes('Google UK English Male') ||
                voice.name.includes('Microsoft David') ||
                voice.name.toLowerCase().includes('male')
            );
            
            if (maleVoice) {
                utterance.voice = maleVoice;
                console.log('Using male voice: ' + maleVoice.name);
            }
        }
        
        // Speak using phonemic transcription
        function speakWithPhonemicTranscription(phonemicText) {
            console.log(`Speaking with phonemic transcription: "${phonemicText}"`);
            
            // Create utterance
            const utterance = new SpeechSynthesisUtterance(phonemicText);
            
            // Set appropriate rate and pitch for male voice
            utterance.rate = 0.8;
            utterance.pitch = 0.9;
            utterance.volume = 1.0;
            utterance.lang = 'en-US';
            
            // Configure for male voice
            configureForMaleVoice(utterance);
            
            // Speak with appropriate timing
            setTimeout(() => {
                window.speechSynthesis.speak(utterance);
                console.log('Speaking with phonemic approach');
            }, 100);
        }
        
        // Get proper phonetic representation for a blend
        function getPhoneticRepresentation(blend) {
            // Pre-process the blend for better pronunciation
            const cleanBlend = blend.trim();
            
            // Log what we're trying to pronounce
            console.log(`Getting pronunciation for: "${cleanBlend}"`);
            
            // Handle special cases for improved pronunciation
            const overrides = {
                // Short vowel overrides - two-letter blends with compact pronunciation (no spelling)
                'bÄƒ': 'bat',
                'cÄƒ': 'cat',
                'dÄƒ': 'dad',
                'fÄƒ': 'fat',
                'gÄƒ': 'gal',
                'hÄƒ': 'hat',
                'jÄƒ': 'jam',
                'kÄƒ': 'kat',
                'lÄƒ': 'lab',
                'mÄƒ': 'mat',
                'nÄƒ': 'nap',
                'pÄƒ': 'pat',
                'rÄƒ': 'rat',
                'sÄƒ': 'sat',
                'tÄƒ': 'tap',
                'vÄƒ': 'van',
                'wÄƒ': 'wham',
                'yÄƒ': 'yap',
                'zÄƒ': 'zap',
                
                'bÄ•': 'bed',
                'cÄ•': 'said',
                'dÄ•': 'dead',
                'fÄ•': 'fetch', // Changed to 'fetch' to fix letter-by-letter pronunciation
                'gÄ•': 'jet',
                'hÄ•': 'hen',
                'jÄ•': 'jet',
                'kÄ•': 'ken',
                'lÄ•': 'let',
                'mÄ•': 'men',
                'nÄ•': 'net',
                'pÄ•': 'pet',
                'rÄ•': 'rep', // Changed to 'rep' to fix letter-by-letter pronunciation // Changed to ret as requested
                'sÄ•': 'set',
                'tÄ•': 'ten',
                'vÄ•': 'vet',
                'wÄ•': 'wet',
                'yÄ•': 'yet',
                'zÄ•': 'zen',
                
                'bÄ­': 'bit',
                'cÄ­': 'sit',
                'dÄ­': 'did',
                'fÄ­': 'fit',
                'gÄ­': 'jit',  // Changed to jit as requested
                'hÄ­': 'hit',
                'jÄ­': 'jig',
                'kÄ­': 'kit',
                'lÄ­': 'lit',
                'mÄ­': 'mit',
                'nÄ­': 'nip',
                'pÄ­': 'pit',
                'rÄ­': 'rip',  // Changed to rip for proper blend sound
                'sÄ­': 'sit',
                'tÄ­': 'tip',
                'vÄ­': 'vit', // Using 'vit' for Short I
                'wÄ­': 'win',
                'yÄ­': 'yip',
                'zÄ­': 'zip',
                
                'bÅ': 'bot',
                'cÅ': 'cot',
                'dÅ': 'dot',
                'fÅ': 'fought',
                'gÅ': 'got',
                'hÅ': 'hot',
                'jÅ': 'job',
                'kÅ': 'cot',
                'lÅ': 'lot',
                'mÅ': 'mop',
                'nÅ': 'not',
                'pÅ': 'pot',
                'rÅ': 'rot',
                'sÅ': 'sob',
                'tÅ': 'top',
                'vÅ': 'fought',
                'wÅ': 'wok',
                'yÅ': 'yot',
                'zÅ': 'zom',
                
                'bÅ­': 'buh',    // Changed from 'but' to 'buh' for consistent Short U sound
                'cÅ­': 'cut',    // Changed back to 'cut' as requested
                'dÅ­': 'duh',    // Changed from 'dug' to 'duh' for consistent Short U sound
                'fÅ­': 'fuh',    // Changed from 'fun' to 'fuh' for consistent Short U sound
                'gÅ­': 'gut',    // Changed back to 'gut' as requested
                'hÅ­': 'huh',    // Changed from 'hut' to 'huh' for consistent Short U sound
                'jÅ­': 'jut',    // Changed from 'jug' to 'jut' as requested
                'kÅ­': 'kuh',    // Changed from 'cut' to 'kuh' for consistent Short U sound
                'lÅ­': 'lut',    // Changed from 'luh' to 'lut' as requested
                'mÅ­': 'muh',    // Changed from 'mud' to 'muh' for consistent Short U sound
                'nÅ­': 'nuh',    // Changed from 'nudge' to 'nuh' for consistent Short U sound
                'pÅ­': 'puh',    // Changed from 'pup' to 'puh' for consistent Short U sound
                'rÅ­': 'rut',    // Changed from 'ruh' to 'rut' as requested
                'sÅ­': 'sut',    // Changed from 'suh' to 'sut' as requested
                'tÅ­': 'tuh',    // Changed from 'tug' to 'tuh' for consistent Short U sound
                'vÅ­': 'vuh',    // Changed from 'vut' to 'vuh' for consistent Short U sound
                'wÅ­': 'wuh',    // Changed from 'what' to 'wuh' for consistent Short U sound
                'yÅ­': 'yuh',    // Changed from 'yum' to 'yuh' for consistent Short U sound
                'zÅ­': 'zut',    // Changed from 'zuh' to 'zut' as requested
                
                // Problematic blends that need more distinct pronunciation
                'shÄ': 'shay',
                'shÄ“': 'shee',
                'shÄ«': 'sheye',
                'shÅ': 'show',
                'shÅ«': 'shoo',
                'shÄƒ': 'shah',
                'shÄ•': 'shelf',
                'shÄ­': 'shi',
                'shÅ': 'sho',
                'shÅ­': 'shu',
                // Special handling for the 'qu' sound since it's unique
                'qÄƒ': 'quah',
                
                // Long vowel sounds - Long A
                'bÄ': 'bay',
                'cÄ': 'kay',
                'dÄ': 'day',
                'fÄ': 'fay',
                'gÄ': 'gay',
                'hÄ': 'hay',
                'jÄ': 'jay',
                'kÄ': 'kay',
                'lÄ': 'lay',
                'mÄ': 'may',
                'nÄ': 'nay',
                'pÄ': 'pay',
                'rÄ': 'ray',
                'sÄ': 'say',
                'tÄ': 'tay',
                'vÄ': 'vay',
                'wÄ': 'way',
                'yÄ': 'yay',
                'zÄ': 'zay',
                
                // Long vowel sounds - Long E
                'bÄ“': 'bee',
                'cÄ“': 'see',
                'dÄ“': 'dee',
                'fÄ“': 'fee',
                'gÄ“': 'gee',
                'hÄ“': 'hee',
                'jÄ“': 'jeep', // Updated to use 'jeep' for clarity
                'kÄ“': 'kee',
                'lÄ“': 'lee',
                'mÄ“': 'mee',
                'nÄ“': 'nee', // Fixed from 'na' to 'nee'
                'pÄ“': 'pee',
                'rÄ“': 'ree',
                'sÄ“': 'see',
                'tÄ“': 'tee',
                'vÄ“': 'vee',
                'wÄ“': 'wee',
                'yÄ“': 'yee',
                'zÄ“': 'zee',
                
                // Three letter overrides - comprehensive list
                // th- blends
                'thÄ': 'thay',
                'thÄ“': 'thee',
                'thÄ«': 'thigh',
                'thÅ': 'though',
                'thÅ«': 'through', // Changed back to "through" as requested
                'thÄƒ': 'thah',
                'thÄ•': 'then',
                'thÄ­': 'thih',
                'thÅ': 'thoh',
                'thÅ­': 'thuh',
                
                // qu- blends
                'quÄ': 'quake',
                'quÄ“': 'quee',
                'quÄ«': 'quite', // Using "quite" for clear Long I sound
                'quÅ': 'quo',
                'quÅ«': 'queue', // Using "queue" for proper Long U sound
                'quÄƒ': 'quah',
                'quÄ•': 'quest',
                'quÄ­': 'quih',
                'quÅ': 'quoh',
                'quÅ­': 'quuh',
                
                // wh- blends
                'whÄ': 'wait',
                'whÄ“': 'whee',
                'whÄ«': 'why',
                'whÅ': 'whoa',
                'whÅ«': 'woo', // Changed from who to woo as requested
                'whÄƒ': 'whah',
                'whÄ•': 'when',
                'whÄ­': 'whih',
                'whÅ': 'whoh',
                'whÅ­': 'whuh',
                
                // ph- blends
                'phÄ': 'fate',
                'phÄ“': 'phee',
                'phÄ«': 'phigh',
                'phÅ': 'pho',
                'phÅ«': 'phew', // Using "phew" for proper Long U sound
                'phÄƒ': 'phah',
                'phÄ•': 'phenom',
                'phÄ­': 'phih',
                'phÅ': 'phoh',
                'phÅ­': 'phuh',
                
                // bl- blends
                'blÄ': 'blay',
                'blÄ“': 'blee',
                'blÄ«': 'bligh',
                'blÅ': 'bloh',
                'blÅ«': 'blue', // Using "blue" for proper Long U sound
                'blÄƒ': 'black', // Using "black" for proper Short A sound
                'blÄ•': 'blend',
                'blÄ­': 'blih',
                'blÅ': 'bloh',
                'blÅ­': 'room',
                
                // cl- blends
                'clÄ': 'clay',
                'clÄ“': 'clee',
                'clÄ«': 'cligh',
                'clÅ': 'cloh', // Using "cloh" for proper Long O sound
                'clÅ«': 'clue', // Using "clue" for proper Long U sound
                'clÄƒ': 'clah',
                'clÄ•': 'clef',
                'clÄ­': 'clih',
                'clÅ': 'cloh',
                'clÅ­': 'cluh',
                
                // fl- blends
                'flÄ': 'flay',
                'flÄ“': 'flee',
                'flÄ«': 'fligh',
                'flÅ': 'flow', // Changed from floh to flow as requested
                'flÅ«': 'flute', // Using "flute" for proper Long U sound
                'flÄƒ': 'flah',
                'flÄ•': 'flesh',
                'flÄ­': 'flih',
                'flÅ': 'floh',
                'flÅ­': 'fluh',
                
                // gl- blends
                'glÄ': 'glay',
                'glÄ“': 'glee',
                'glÄ«': 'gligh',
                'glÅ': 'gloh',
                'glÅ«': 'glue', // Using "glue" for proper Long U sound
                'glÄƒ': 'glah',
                'glÄ•': 'glen',
                'glÄ­': 'glih',
                'glÅ': 'gloh',
                'glÅ­': 'gluh',
                
                // pl- blends
                'plÄ': 'play',
                'plÄ“': 'plea',
                'plÄ«': 'pligh',
                'plÅ': 'ploh', // Using "ploh" for proper Long O sound
                'plÅ«': 'plume', // Using "plume" for proper Long U sound
                'plÄƒ': 'plah',
                'plÄ•': 'pledge',
                'plÄ­': 'plih',
                'plÅ': 'ploh',
                'plÅ­': 'pluh',
                
                // sl- blends
                'slÄ': 'slay',
                'slÄ“': 'slee',
                'slÄ«': 'sligh',
                'slÅ': 'sloh',
                'slÅ«': 'sloop', // Using "sloop" for proper Long U sound
                'slÄƒ': 'slat', // Using "slat" for proper Short A sound
                'slÄ•': 'sled',
                'slÄ­': 'slih',
                'slÅ': 'sloh',
                'slÅ­': 'sluh',
                
                // br- blends
                'brÄ': 'bray',
                'brÄ“': 'bree',
                'brÄ«': 'brigh',
                'brÅ': 'broh', // Using "broh" for proper Long O sound
                'brÅ«': 'brew', // Using "brew" for proper Long U sound
                'brÄƒ': 'brat', // Using "brat" for proper Short A sound
                'brÄ•': 'bread',
                'brÄ­': 'brih',
                'brÅ': 'broh',
                'brÅ­': 'bruh',
                
                // cr- blends
                'crÄ': 'cray',
                'crÄ“': 'cree',
                'crÄ«': 'crigh',
                'crÅ': 'croh',
                'crÅ«': 'crew', // Using "crew" for proper Long U sound
                'crÄƒ': 'crah',
                'crÄ•': 'crest',
                'crÄ­': 'crih',
                'crÅ': 'croh',
                'crÅ­': 'cruh',
                
                // dr- blends
                'drÄ': 'dray',
                'drÄ“': 'dree',
                'drÄ«': 'drigh',
                'drÅ': 'droh', // Using "droh" for proper Long O sound
                'drÅ«': 'drew', // Using "drew" for proper Long U sound
                'drÄƒ': 'drah',
                'drÄ•': 'dread',
                'drÄ­': 'drih',
                'drÅ': 'droh',
                'drÅ­': 'druh',
                
                // fr- blends
                'frÄ': 'fray',
                'frÄ“': 'free',
                'frÄ«': 'frigh',
                'frÅ': 'froh', // Using "froh" for proper Long O sound
                'frÅ«': 'fruit', // Using "fruit" for proper Long U sound
                'frÄƒ': 'frah',
                'frÄ•': 'fresh',
                'frÄ­': 'frih',
                'frÅ': 'froh',
                'frÅ­': 'fruh',
                
                // gr- blends
                'grÄ': 'gray',
                'grÄ“': 'gree',
                'grÄ«': 'grigh',
                'grÅ': 'groh', // Using "groh" for proper Long O sound
                'grÅ«': 'grew', // Using "grew" for proper Long U sound
                'grÄƒ': 'grah',
                'grÄ•': 'great',
                'grÄ­': 'grih',
                'grÅ': 'groh',
                'grÅ­': 'gruh',
                
                // pr- blends
                'prÄ': 'pray',
                'prÄ“': 'pree',
                'prÄ«': 'prigh',
                'prÅ': 'proh', // Using "proh" for proper Long O sound
                'prÅ«': 'prune', // Using "prune" for proper Long U sound
                'prÄƒ': 'prah',
                'prÄ•': 'press',
                'prÄ­': 'prih',
                'prÅ': 'proh',
                'prÅ­': 'pruh',
                
                // tr- blends
                'trÄ': 'tray',
                'trÄ“': 'tree',
                'trÄ«': 'trigh',
                'trÅ': 'troh', // Using "troh" for proper Long O sound
                'trÅ«': 'true', // Using "true" for proper Long U sound
                'trÄƒ': 'trah',
                'trÄ•': 'tread',
                'trÄ­': 'trih',
                'trÅ': 'troh',
                'trÅ­': 'truh',
                
                // ch- blends (with distinct pronunciation from sh-)
                'chÄ': 'chay',
                'chÄ“': 'chee',
                'chÄ«': 'chime',  // Using "chime" with clear 'ch' sound
                'chÅ': 'chote', // Changed from choh to chote as requested
                'chÅ«': 'chew', // Using "chew" for proper Long U sound
                'chÄƒ': 'chat', // Using "chat" for proper Short A sound
                'chÄ•': 'check',
                'chÄ­': 'chih',
                'chÅ': 'choh',
                'chÅ­': 'chuh',
                
                // sh- blends
                'shÄ': 'shay',
                'shÄ“': 'she',
                'shÄ«': 'shigh',
                'shÅ': 'shoh',
                'shÅ«': 'shoe',
                'shÄƒ': 'shack', // Using "shack" for proper Short A sound
                'shÄ•': 'sheh',
                'shÄ­': 'shih',
                'shÅ': 'shoh',
                'shÅ­': 'shuh',
                
                // Additional common trigraphs with proper short A sounds
                'scÄƒ': 'scan', // Using "scan" for proper Short A sound
                'stÄƒ': 'stack', // Using "stack" for proper Short A sound
                'smÄƒ': 'smack', // Using "smack" for proper Short A sound
                'snÄƒ': 'snap', // Using "snap" for proper Short A sound
                'swÄƒ': 'swam', // Using "swam" for proper Short A sound
                'twÄƒ': 'tan', // Using "tan" for proper Short A sound
                
                // Additional Long I trigraphs
                'scÄ«': 'sigh',  // Using "sigh" for sci sound
                'stÄ«': 'stigh',
                'smÄ«': 'smigh',
                'snÄ«': 'snigh',
                'swÄ«': 'swigh',
                'twÄ«': 'twigh',
                
                // Additional Long O trigraphs
                'scÅ': 'scoh',  // Using "scoh" for proper Long O sound
                'stÅ': 'stow',  // Changed from stoh to stow as requested
                'smÅ': 'smoh',  // Using "smoh" for proper Long O sound
                'snÅ': 'snow',  // Using "snow" for proper Long O sound
                'swÅ': 'swoh',  // Using "swoh" for proper Long O sound
                'twÅ': 'twoh',  // Using "twoh" for proper Long O sound
                
                // Additional Long U trigraphs
                'scÅ«': 'scoot',  // Using "scoot" for proper Long U sound
                'stÅ«': 'stew',  // Using "stew" for proper Long U sound
                'smÅ«': 'smooth',  // Using "smooth" for proper Long U sound
                'snÅ«': 'snooze',  // Changed back to "snooze" as requested
                'swÅ«': 'swoon',  // Changed back to "swoon" as requested
                'twÅ«': 'too',  // Using "too" for proper Long U sound
                'thÅ«': 'through',  // Changed back to "through" as requested
                'quÅ«': 'queue',  // Using "queue" for proper Long U sound
                
                // th- blends with proper short vowel pronunciations
                'thÄƒ': 'that', // Using "that" for proper Short A sound
                'thÄ•': 'then', // Using "then" for proper Short E sound
                'thÄ­': 'this', // Using "this" for proper Short I sound
                'thÅ': 'thot', // Using "thot" for proper Short O sound
                'thÅ­': 'thud', // Using "thud" for proper Short U sound
                
                // ph- blends with proper short vowel pronunciations
                'phÄƒ': 'phat', // Using "phat" for proper Short A sound
                'phÄ•': 'fetch', // Using "fetch" for proper Short E sound as requested
                'phÄ­': 'phil', // Using "phil" for proper Short I sound
                'phÅ': 'phon', // Using "phon" (as in phonics) for proper Short O sound
                'phÅ­': 'phun', // Using "phun" for proper Short U sound
                
                // wh- blends with proper short vowel pronunciations
                'whÄƒ': 'whack', // Using "whack" for proper Short A sound
                'whÄ•': 'when', // Using "when" for proper Short E sound
                'whÄ­': 'whip', // Using "whip" for proper Short I sound
                'whÅ': 'what', // Using "what" for proper Short O sound (approximate)
                'whÅ­': 'what', // Using "what" for proper Short U sound as requested
                
                // qu- blends with proper short vowel pronunciations
                'quÄƒ': 'quack', // Using "quack" for proper Short A sound
                'quÄ•': 'quest', // Using "quest" for proper Short E sound
                'quÄ­': 'quick', // Using "quick" for proper Short I sound
                'quÅ': 'quad', // Using "quad" for proper Short O sound
                'quÅ­': 'quup', // Using "quup" as approximation for Short U sound
                
                // Other trigraphs with short vowel sounds - using short vowel template words
                'scÄ•': 'scent',  // Using "scent" for proper Short E sound
                'scÄ­': 'scip',  // Using approximation for proper Short I sound
                'scÅ': 'scoff', // Using "scoff" for proper Short O sound
                'scÅ­': 'scuff', // Using "scuff" for proper Short U sound
                'stÄ•': 'step',   // Using "step" for proper Short E sound
                'stÄ­': 'stick',  // Using "stick" for proper Short I sound
                'stÅ': 'stop',   // Using "stop" for proper Short O sound
                'stÅ­': 'stuff',  // Using "stuff" for proper Short U sound
                'smÄ•': 'smell',  // Using "smell" for proper Short E sound
                'smÄ­': 'smith',  // Using "smith" for proper Short I sound
                'smÅ': 'smock',  // Using "smock" for proper Short O sound
                'smÅ­': 'smug',   // Using "smug" for proper Short U sound
                'snÄ•': 'snell',  // Using "snell" for proper Short E sound
                'snÄ­': 'sniff',  // Using "sniff" for proper Short I sound
                'snÅ': 'snot',   // Using "snot" for proper Short O sound
                'snÅ­': 'snub',  // Using "snub" for proper Short U sound as requested
                'swÄ•': 'swell',  // Using "swell" for proper Short E sound
                'swÄ­': 'swift',  // Using "swift" for proper Short I sound
                'swÅ': 'swosh',  // Using approximation for proper Short O sound
                'swÅ­': 'swum',   // Using "swum" for proper Short U sound
                'twÄ•': 'ten', // Using "ten" for proper Short E sound as requested
                'twÄ­': 'twig',   // Using "twig" for proper Short I sound
                'twÅ': 'twock',  // Using approximation for proper Short O sound
                'twÅ­': 'twump'   // Using approximation for proper Short U sound
            };
            
            // Check if there's an override for this blend
            if (overrides[cleanBlend]) {
                const result = overrides[cleanBlend];
                console.log(`Found override for "${cleanBlend}": "${result}"`);
                return result;
            }
            
            // Generic rules for pronunciation with additional spacing for clarity
            // Handle long vowels
            if (cleanBlend.includes('Ä')) {
                const result = cleanBlend.replace('Ä', 'ay');
                console.log(`Long A vowel in "${cleanBlend}" -> "${result}"`);
                return result;
            } else if (cleanBlend.includes('Ä“')) {
                const result = cleanBlend.replace('Ä“', 'ee');
                console.log(`Long E vowel in "${cleanBlend}" -> "${result}"`);
                return result;
            } else if (cleanBlend.includes('Ä«')) {
                const result = cleanBlend.replace('Ä«', 'eye');
                console.log(`Long I vowel in "${cleanBlend}" -> "${result}"`);
                return result;
            } else if (cleanBlend.includes('Å')) {
                const result = cleanBlend.replace('Å', 'oh');
                console.log(`Long O vowel in "${cleanBlend}" -> "${result}"`);
                return result;
            } else if (cleanBlend.includes('Å«')) {
                const result = cleanBlend.replace('Å«', 'ue');
                console.log(`Long U vowel in "${cleanBlend}" -> "${result}"`);
                return result;
            }
            
            // Handle short vowels with simplified phonetic representation
            if (cleanBlend.includes('Äƒ')) {
                // Short 'a''cat'
                let consonant = cleanBlend.replace('Äƒ', '');
                const result = consonant + 'a';
                console.log(`Short A vowel in "${cleanBlend}" -> "${result}"`);
                return result;
            } else if (cleanBlend.includes('Ä•')) {
                // Short 'e''bet'
                let consonant = cleanBlend.replace('Ä•', '');
                const result = consonant + 'e';
                console.log(`Short E vowel in "${cleanBlend}" -> "${result}"`);
                return result;
            } else if (cleanBlend.includes('Ä­')) {
                // Short 'i''bit'
                let consonant = cleanBlend.replace('Ä­', '');
                const result = consonant + 'i';
                console.log(`Short I vowel in "${cleanBlend}" -> "${result}"`);
                return result;
            } else if (cleanBlend.includes('Å')) {
                // Short 'o''hot'
                let consonant = cleanBlend.replace('Å', '');
                const result = consonant + 'o';
                console.log(`Short O vowel in "${cleanBlend}" -> "${result}"`);
                return result;
            } else if (cleanBlend.includes('Å­')) {
                // Short 'u''but'
                let consonant = cleanBlend.replace('Å­', '');
                const result = consonant + 'u';
                console.log(`Short U vowel in "${cleanBlend}" -> "${result}"`);
                return result;
            }
            
            // Default - just return the blend as is without spacing
            console.log(`No special handling for "${cleanBlend}", using as is`);
            return cleanBlend;
        }
        
        // Utility function to shuffle an array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
    </script>
    
    <!-- Script to ensure the correct font sizes are applied -->
    <script>
        // Wait for the DOM to be fully loaded and the charts to be rendered
        document.addEventListener('DOMContentLoaded', function() {
            // Log that we're keeping the font sizes specified in CSS
            console.log("Using CSS-defined font sizes for blend cells");
            console.log("Two-letter blends: 36px desktop, 28px mobile");
            console.log("Three-letter blends: 32px desktop, 24px mobile");
            
            // Setup Decoding Blends Charts Button
            const magicChartsBtn = document.getElementById('magic-charts-btn');
            const chartsArea = document.getElementById('charts-area');
            
            if (magicChartsBtn && chartsArea) {
                console.log('Setting up Decoding Blends Charts button');
                
                magicChartsBtn.addEventListener('click', function() {
                    if (chartsArea.style.display === 'none') {
                        // Show charts with fade-in effect
                        chartsArea.style.opacity = '0';
                        chartsArea.style.display = 'block';
                        
                        // Animate fade-in
                        setTimeout(() => {
                            chartsArea.style.transition = 'opacity 0.8s ease-in-out';
                            chartsArea.style.opacity = '1';
                            
                            // Scroll to charts area
                            chartsArea.scrollIntoView({behavior: 'smooth', block: 'start'});
                        }, 50);
                        
                        // Update button text
                        magicChartsBtn.querySelector('span').textContent = 'Hide Decoding Blends Charts';
                        
                        // Add a subtle sparkle animation to the button
                        magicChartsBtn.style.animation = 'none';
                        setTimeout(() => {
                            magicChartsBtn.style.animation = 'glow 2s infinite alternate';
                        }, 10);
                    } else {
                        // Hide charts with fade-out
                        chartsArea.style.transition = 'opacity 0.5s ease-in-out';
                        chartsArea.style.opacity = '0';
                        
                        setTimeout(() => {
                            chartsArea.style.display = 'none';
                            
                            // Reset button text
                            magicChartsBtn.querySelector('span').textContent = 'Decoding Blends Charts';
                            
                            // Scroll to button
                            magicChartsBtn.scrollIntoView({behavior: 'smooth', block: 'center'});
                        }, 500);
                    }
                });
                
                // Add a subtle animation to attract attention to the button initially
                setTimeout(() => {
                    magicChartsBtn.classList.add('pulse');
                    setTimeout(() => {
                        magicChartsBtn.classList.remove('pulse');
                    }, 1500);
                }, 1000);
            }
        });
        
        // Benefits Toggle Button Functionality
        const benefitsButton = document.getElementById('benefits-button');
        const benefitsContent = document.getElementById('benefits-content');
        
        if (benefitsButton && benefitsContent) {
            benefitsButton.addEventListener('click', function() {
                if (benefitsContent.style.display === 'none') {
                    benefitsContent.style.display = 'block';
                    benefitsButton.classList.add('active');
                } else {
                    benefitsContent.style.display = 'none';
                    benefitsButton.classList.remove('active');
                }
            });
        }
        
        // Decoding Blends Charts Effectiveness Toggle Functionality
        const effectivenessButton = document.getElementById('effectiveness-button');
        const effectivenessContent = document.getElementById('effectiveness-content');
        
        if (effectivenessButton && effectivenessContent) {
            effectivenessButton.addEventListener('click', function() {
                if (effectivenessContent.style.display === 'none') {
                    effectivenessContent.style.display = 'block';
                    effectivenessButton.classList.add('active');
                } else {
                    effectivenessContent.style.display = 'none';
                    effectivenessButton.classList.remove('active');
                }
            });
        }
        
        // Navigation Toggle Functionality
        const navigationButton = document.getElementById('navigation-button');
        const navigationContent = document.getElementById('navigation-content');
        
        if (navigationButton && navigationContent) {
            navigationButton.addEventListener('click', function() {
                if (navigationContent.style.display === 'none') {
                    navigationContent.style.display = 'block';
                    navigationButton.classList.add('active');
                } else {
                    navigationContent.style.display = 'none';
                    navigationButton.classList.remove('active');
                }
            });
        }
        
        // Maximum Benefit Toggle Functionality
        const maximumBenefitButton = document.getElementById('maximum-benefit-button');
        const maximumBenefitContent = document.getElementById('maximum-benefit-content');
        
        if (maximumBenefitButton && maximumBenefitContent) {
            maximumBenefitButton.addEventListener('click', function() {
                if (maximumBenefitContent.style.display === 'none') {
                    maximumBenefitContent.style.display = 'block';
                    maximumBenefitButton.classList.add('active');
                } else {
                    maximumBenefitContent.style.display = 'none';
                    maximumBenefitButton.classList.remove('active');
                }
            });
        }
    
        // Direct pronunciation overrides - this ensures our customizations are applied
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Applying final pronunciation overrides...");
            
            // Debug cell structure to understand how they're defined
            const allCells = document.querySelectorAll('td');
            console.log(`Found ${allCells.length} total cells in tables`);
            
            // Print attributes of the first 5 cells to understand structure
            Array.from(allCells).slice(0, 5).forEach((cell, i) => {
                console.log(`Cell ${i} properties:`, {
                    classes: cell.className,
                    id: cell.id,
                    attributes: Array.from(cell.attributes).map(attr => `${attr.name}="${attr.value}"`).join(', '),
                    innerHTML: cell.innerHTML.substring(0, 50) + (cell.innerHTML.length > 50 ? '...' : '')
                });
            });
            
            // Look for specific blend cells we want to modify
            ['gÄ­', 'rÄ­', 'fÄ•', 'gÄ•', 'rÄ•', 'fÅ', 'kÅ', 'wÅ«', 'gÄ«', 'vÄ«'].forEach(blend => {
                console.log(`Searching for elements containing text "${blend}"...`);
                document.querySelectorAll('td').forEach(cell => {
                    if (cell.textContent.includes(blend)) {
                        console.log(`Found cell containing "${blend}":`, {
                            classes: cell.className,
                            id: cell.id,
                            attributes: Array.from(cell.attributes).map(attr => `${attr.name}="${attr.value}"`).join(', '),
                            text: cell.textContent
                        });
                    }
                });
            });
            
            // Override function for specific blends
            const overrideBlendPronunciation = function(blend, pronunciation) {
                // Create an override function for this specific blend
                window[`speak_${blend}`] = function() {
                    console.log(`OVERRIDE: Speaking custom pronunciation for ${blend}: "${pronunciation}"`);
                    const utterance = new SpeechSynthesisUtterance(pronunciation);
                    utterance.rate = 0.8;
                    
                    // Adding special handling for letter-by-letter reading issues
                    if (blend === 'rÄ­') {
                        // Setting specific speech parameters to prevent letter-by-letter reading
                        utterance.pitch = 1.1;
                        utterance.rate = 0.7;
                    }
                    else if (blend === 'fÄ•') {
                        // Setting specific speech parameters to prevent letter-by-letter reading
                        utterance.pitch = 1.0;
                        utterance.rate = 0.75;
                    }
                    else if (blend === 'vÄ«') {
                        // Setting specific speech parameters for long I sound in "vite"
                        utterance.pitch = 1.0;
                        utterance.rate = 0.65;
                        utterance.volume = 1.2; // Slightly louder for emphasis
                    }
                    
                    window.speechSynthesis.cancel(); // Clear queue
                    window.speechSynthesis.speak(utterance);
                };
                
                // Try multiple strategies to find the blend cells
                let elements = [];
                
                // Strategy 1: Look for data-blend attribute
                const dataBlendElements = document.querySelectorAll(`td[data-blend="${blend}"], .blend-cell[data-blend="${blend}"]`);
                elements = elements.concat(Array.from(dataBlendElements));
                
                // Strategy 2: Look for cells with exact text content
                document.querySelectorAll('td').forEach(cell => {
                    if (cell.textContent.trim() === blend) {
                        elements.push(cell);
                    }
                });
                
                // Strategy 3: Look for cells with blend in text content
                document.querySelectorAll('td').forEach(cell => {
                    if (cell.textContent.includes(blend) && !elements.includes(cell)) {
                        elements.push(cell);
                    }
                });
                
                // Strategy 4: Add click handlers to ALL cells and use filter at runtime
                document.querySelectorAll('td').forEach(cell => {
                    const originalOnClick = cell.onclick;
                    cell.onclick = function(event) {
                        // If this is the blend we're looking for, use our override
                        if (cell.textContent.includes(blend)) {
                            console.log(`Intercepted click on cell containing ${blend}, using override`);
                            window[`speak_${blend}`]();
                            event.stopPropagation();
                            return false;
                        }
                        // Otherwise, use the original handler
                        if (originalOnClick) {
                            return originalOnClick.call(this, event);
                        }
                    };
                });
                
                console.log(`Found ${elements.length} elements for blend "${blend}"`);
                
                // Apply direct override to found elements
                elements.forEach(cell => {
                    console.log(`Directly overriding click handler for ${blend} element:`, cell);
                    const originalOnClick = cell.onclick;
                    cell.onclick = function(event) {
                        console.log(`Executing override for ${blend}`);
                        window[`speak_${blend}`]();
                        event.stopPropagation();
                        return false;
                    };
                });
                
                // Also inject the pronunciation into the global map
                if (window.pronunciationOverrides) {
                    window.pronunciationOverrides[blend] = pronunciation;
                } else {
                    window.pronunciationOverrides = { [blend]: pronunciation };
                }
                
                // Hook into the original playBlendAudio function if it exists
                if (window.playBlendAudio) {
                    const originalPlayBlendAudio = window.playBlendAudio;
                    window.playBlendAudio = function(blend) {
                        if (window.pronunciationOverrides && window.pronunciationOverrides[blend]) {
                            console.log(`Intercepted playBlendAudio call for ${blend}, using override`);
                            const utterance = new SpeechSynthesisUtterance(window.pronunciationOverrides[blend]);
                            utterance.rate = 0.8;
                            window.speechSynthesis.cancel();
                            window.speechSynthesis.speak(utterance);
                            return;
                        }
                        return originalPlayBlendAudio.call(this, blend);
                    };
                }
            };
            
            // Apply our specific overrides
            // Short I
            overrideBlendPronunciation('gÄ­', 'jit');
            overrideBlendPronunciation('rÄ­', 'rip');
            
            // Short E
            overrideBlendPronunciation('fÄ•', 'fetch');
            overrideBlendPronunciation('gÄ•', 'jet');
            overrideBlendPronunciation('rÄ•', 'rep');
            
            // Long O
            overrideBlendPronunciation('fÅ', 'fote');
            overrideBlendPronunciation('kÅ', 'coat');
            
            // Long U
            overrideBlendPronunciation('wÅ«', 'woot');
            
            // Long I
            overrideBlendPronunciation('gÄ«', 'jive');
            overrideBlendPronunciation('vÄ«', 'vipe'); // Changed to vipe for better pronunciation
            
            console.log("Final pronunciation overrides applied.");
        });
        // Add a verification function to initialize and test our pronunciation overrides
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Verifying pronunciation overrides...");
            
            // Verify the special handling for Short I blends
            console.log("Verifying Short I blends: gÄ­â†’jit, rÄ­â†’rip");
            
            // Verify the special handling for Short E blends
            console.log("Verifying Short E blends: fÄ•â†’fetch, gÄ•â†’jet, rÄ•â†’ret");
            
            // Verify the special handling for Long O sounds
            console.log("Verifying Long O blends: fÅâ†’fote, kÅâ†’coat");
            
            // Verify the special handling for Long U sounds
            console.log("Verifying Long U blend: wÅ«â†’woot");
            
            // Verify the special handling for Long I sounds
            console.log("Verifying Long I blends: gÄ«â†’jive, vÄ«â†’vipe");
            
            console.log("All pronunciation overrides verified!");
        });
    </script>
</body>
</html>
